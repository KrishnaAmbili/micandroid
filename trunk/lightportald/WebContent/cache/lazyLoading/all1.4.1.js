Light.securityCheck=function(){if(!Light.isLogin()){Light.showAllLogin(false);return false}else{return true}};Light.signUpAfter=function(id,userId){if(Light.portal.latestAction.method!=null){Light.userId=userId;Light.setCookie(Light._LOGINED_USER_ID,Light.userId);Light.deleteCookie(Light._CURRENT_TAB);Light.deleteCookie(Light._IS_SIGN_OUT);Light.portal.latestAction.portlet.close(true);Light.getPortletById(id).close(true);Light.setSessionTimer();Light.portal.refreshPortalMenu();var method=Light.portal.latestAction.method+"(null,'"+Light.portal.latestAction.id+"')";eval(method)}else{Light.reloadPortal()}};Light.validateOpenIdLogin=function(a){if(a.openid_identifier.value==null||a.openid_identifier.value.length<=8){Light.alert("Please input correct OpenID URL.");return false}else{return true}};Light.loginPortal=function(e){var b=document.forms["form_"+e]["email"].value;var a=document.forms["form_"+e]["password"].value;if(!b||!a){Light.alert("please input User ID and password.");return}Light.userId=b;if(!document.forms["form_"+e]["rememberMe"].checked){Light.deleteCookie(Light._REMEMBERED_USER_ID);Light.deleteCookie(Light._REMEMBERED_USER_PASSWORD)}var d=Light.getPortletById(e);var c="portletId="+d.serverId+"&tabId="+d.parent.serverId+"&userId="+escape(encodeURIComponent(b))+"&password="+escape(encodeURIComponent(a));if(document.forms["form_"+e]["rememberMe"].checked){c+="&rememberme=1"}Light.ajax.sendRequest(Light._LOGIN,{parameters:c,method:"post",onSuccess:Light.loginPortalHandler})};Light.loginPortalHandler=function(b){var a=JSON.parse(b.responseText);if(a.status=="1"){Light.setCookie(Light._LOGINED_USER_ID,Light.userId);Light.deleteCookie(Light._CURRENT_TAB);Light.deleteCookie(Light._IS_SIGN_OUT);Light.needRender=true;Light.needReload=true;Light.refreshPortal()}else{Light.userId=null;Light.deleteCookie(Light._REMEMBERED_USER_ID);Light.deleteCookie(Light._REMEMBERED_USER_PASSWORD);if(a.status=="0"){Light.alert("This User ID is not signed up yet , please sign up first.")}else{if(a.status=="-1"){Light.alert("you input wrong password , please try again.")}else{if(a.status=="-2"){Light.alert("you Account is disabled , please contact with Administrator.")}else{if(a.status=="-3"){Light.alert("you Account is locked, please contact with Administrator.")}else{Light.alert("System error, please contact with Administrator.")}}}}}};Light.loginToPortal=function(e){var b=document.forms["form_"+e]["email"].value;var a=document.forms["form_"+e]["password"].value;if(!b||!a){Light.alert("please input User ID and password.");return}Light.userId=b;if(!document.forms["form_"+e]["rememberMe"].checked){Light.deleteCookie(Light._REMEMBERED_USER_ID);Light.deleteCookie(Light._REMEMBERED_USER_PASSWORD)}var d=Light.getPortletById(e);var c="portletId="+d.serverId+"&tabId="+d.parent.serverId+"&userId="+escape(encodeURIComponent(b))+"&password="+escape(encodeURIComponent(a));if(document.forms["form_"+e]["rememberMe"].checked){c+="&rememberme=1"}Light.ajax.sendRequest(Light._LOGIN,{parameters:c,method:"post",onSuccess:Light.LoginToPortalHandler})};Light.LoginToPortalHandler=function(t){var login=JSON.parse(t.responseText);if(login.status=="1"){Light.setCookie(Light._LOGINED_USER_ID,Light.userId);Light.deleteCookie(Light._CURRENT_TAB);Light.deleteCookie(Light._IS_SIGN_OUT);Light.portal.latestAction.portlet.close(true);Light.setSessionTimer();Light.portal.refreshPortalMenu();if(Light.portal.latestAction.method!=null){var method=Light.portal.latestAction.method+"(null,'"+Light.portal.latestAction.id+"')";eval(method)}else{Light.refreshPortal()}}else{Light.userId=null;Light.deleteCookie(Light._REMEMBERED_USER_ID);Light.deleteCookie(Light._REMEMBERED_USER_PASSWORD);if(login.status=="-1"){Light.alert("This User ID is not signed up yet , please sign up first.")}else{if(login.status=="-2"){Light.alert("you input wrong password , please try again.")}else{if(login.status=="-3"){Light.alert("you Account is disabled , please contact with Administrator.")}else{if(login.status=="-4"){Light.alert("you Account is locked, please contact with Administrator.")}else{Light.alert("System error, please contact with Administrator.")}}}}}};Light.showOpenIdSignIn=function(b){var a=new PortletPopupWindow(11,200,600,Light.getMessage("MENU_SIGN_IN"),"icons openid_small_logo","","openIdSignIn","/openIdSignIn"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","",false,false);a.refresh();Light.addFunctionHistory("Light.showOpenIdSignIn")};Light.showSignUp=function(b){var a=new PortletPopupWindow(11,200,600,Light.getMessage("TITLE_SIGN_UP"),"icons user","","registrationPortlet","/registrationPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","",false,false,true,5,2);a.refresh();Light.addFunctionHistory("Light.showSignUp")};Light.showInboxMessage=function(){var a=new PortletPopupWindow(11,200,400,Light.getMessage("MENU_MESSAGE_INBOX"),"icons inbox","","messagePortlet","/messagePortlet"+Light._REQUEST_SUFFIX,true,true,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0);Light.addFunctionHistory("Light.showInboxMessage")};Light.showSentMessage=function(){var a=new PortletPopupWindow(11,200,400,Light.getMessage("MENU_MESSAGE_SENT"),"icons message","","messagePortlet","/messagePortlet"+Light._REQUEST_SUFFIX,true,true,false,false,false,false,false,0,false,"","","","type=sent");a.refresh();window.scrollTo(0,0);Light.addFunctionHistory("Light.showSentMessage")};Light.showFriendRequest=function(){var a=new PortletPopupWindow(11,200,500,Light.getMessage("MENU_FRIEND_REQUEST"),"icons friend","","messagePortlet","/messagePortlet"+Light._REQUEST_SUFFIX,true,true,false,false,false,false,false,0,false,"","","","type=connection");a.refresh();window.scrollTo(0,0);Light.addFunctionHistory("Light.showFriendRequest")};Light.showInviteFriend=function(){var a=new PortletPopupWindow(11,200,400,Light.getMessage("MENU_INVITE_FRIEND"),"icons friend","","inviteFriendPortlet","/inviteFriendPortlet"+Light._REQUEST_SUFFIX,true,true,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0);Light.addFunctionHistory("Light.showInviteFriend")};Light.showUploader=function(c,a){var b={id:c,popupName:a};createPopupDiv(a,a+".jst",640,b,null,c)};Light.closeUploader=function(c,a){hidePopupDiv(a);var b=Light.getPortletById(c);if(b!=null){b.mode=Light._VIEW_MODE;b.lastAction=null;b.rememberMode(0);b.refresh()}};Light.toMyAccount=function(){Light.setCookie(Light._CURRENT_TAB,0);window.location=Light.getContextPath()+"/ref/myaccount?clientUrl="+document.location.href};Light.toHome=function(){var a=document.location.href;a="http://"+a.substr(a.indexOf(".")+1);if(a.indexOf("#")>0){a=a.substring(0,a.indexOf("#"))}window.location=a};Light.showLinkAction=function(g,b,i,h,d,a){var j=Light.getPortletById(b);if(j==null){return}var c=document.getElementById(a);if(c!=null){hideTopPopupDiv(a);d.src=Light.getContextPath()+"/light/images/showMod.gif";return}var f={id:b,itemId:i,itemLink:h,popupName:a};createTopPopupDiv(a,a+".jst",10,f,g,b,true);L$(a).onmouseout=function(k){hideTopPopupDiv(a,k)}};Light.doLinkAction=function(f,e,c,a){var d=Light.getPortletById(f);if(d==null){return}var b="responseId="+f+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+d.serverId+"&mode="+d.mode+"&action="+c+"&parameter="+e;Light.ajax.sendRequestAndUpdate(d.requestUrl,f,{evalScripts:d.allowJS,parameters:b});hideTopPopupDiv(a)};Light.logout=function(){Light.deleteCookie(Light._LOGINED_USER_ID);Light.deleteCookie(Light._CURRENT_TAB);Light.setCookie(Light._IS_SIGN_OUT,"true");var a="action=logout";Light.ajax.sendRequest(Light._LOGOUT,{parameters:a,onSuccess:Light.logoutHandler})};Light.logoutHandler=function(b){var a=document.location.href;if(a.indexOf("/m.jsp")>0){window.location=Light.getContextPath()+"/m.jsp"}else{window.location=Light.getContextPath()+"/index.jsp"}};Light.closePortlet=function(c,a){if(a==null){a=true}var b=Light.getPortletById(c);if(b!=null){b.close(a)}};Light.changeLanguage=function(c){if(Light.getCookie(Light._USER_LOCALE)){Light.deleteCookie(Light._USER_LOCALE)}var a=new Date();a.setFullYear(a.getFullYear()+1);Light.setCookie(Light._USER_LOCALE,c,a);var b="language="+c;Light.ajax.sendRequest(Light._CHANGE_LANGUAGE,{parameters:b,onSuccess:Light.changeLanguageHandler})};Light.changeLanguageHandler=function(){Light.refreshPortal()};Light.saveLanguage=function(f,e){var a=document.forms["form_"+f]["language"].length;var d=null;for(var b=0;b<a;b++){if(document.forms["form_"+f]["language"][b].checked){d=document.forms["form_"+f]["language"][b].value}}var c="language="+d;if(!e){Light.ajax.sendRequest(Light._CHANGE_LANGUAGE,{parameters:c,onSuccess:Light.saveOptionHandler})}else{Light.closePortlet(f);Light.changeLanguage(d)}};Light.saveOptionHandler=function(a){var b=JSON.parse(a.responseText);var c=L$("optionsMessage");if(c){c.innerHTML=(b.status==1)?"<br/>Option have been saved successfully.":"<br/>Option save failed, please try again"}};Light.saveRegion=function(f,e){var a=document.forms["form_"+f]["region"].length;var c=null;for(var b=0;b<a;b++){if(document.forms["form_"+f]["region"][b].checked){c=document.forms["form_"+f]["region"][b].value}}var d="region="+c;Light.ajax.sendRequest(Light._CHANGE_REGION,{parameters:d,onSuccess:(e)?Light.refreshPortal:Light.saveOptionHandler})};Light.saveTimeZone=function(f,e){var a=document.forms["form_"+f]["timeZone"].length;var b=null;for(var c=0;c<a;c++){if(document.forms["form_"+f]["timeZone"][c].checked){b=document.forms["form_"+f]["timeZone"][c].value}}var d="responseId="+f+"&timeZone="+b;Light.ajax.sendRequest(Light._CHANGE_TIMEZONE,{parameters:d,onSuccess:(e)?Light.closeOption:Light.saveOptionHandler})};Light.closeOption=function(a){Light.closePortlet(a.responseText,true)};Light.saveGeneral=function(e){var d=[];var c=document.forms["form_"+e]["ptFontSize"].value;Light.portal.data.fontSize=c;if(c){d.push("fontSize="+c)}var a=document.forms["form_"+e]["pcTextFont"].value;Light.portal.data.textFont=a;if(a){d.push("textFont="+a)}var b=document.forms["form_"+e]["pcTextColor"].value;if(b){Light.portal.data.textColor=b;d.push("textColor="+b)}if(document.forms["form_"+e]["showSearchBar"].checked&&!Light.portal.data.showSearchBar){Light.portal.data.showSearchBar=true;d.push("showSearchBar=1");Light.portal.refreshPortalMenu()}if(!document.forms["form_"+e]["showSearchBar"].checked&&Light.portal.data.showSearchBar){Light.portal.data.showSearchBar=false;d.push("showSearchBar=0");Light.portal.refreshPortalMenu()}if(document.forms["form_"+e]["transparent"].checked&&!Light.portal.data.portletWindowTransparent){d.push("transparent=1")}if(!document.forms["form_"+e]["transparent"].checked&&Light.portal.data.portletWindowTransparent){d.push("transparent=0")}if((document.forms["form_"+e]["transparent"].checked&&!Light.portal.data.portletWindowTransparent)||(!document.forms["form_"+e]["transparent"].checked&&Light.portal.data.portletWindowTransparent)){Light.portal.data.portletWindowTransparent=!Light.portal.data.portletWindowTransparent;Light.refreshWindowTransparent()}Light.portal.data.maxShowTabs=document.forms["form_"+e]["ptMaxShowTabs"].value;d.push("maxShowTabs="+Light.portal.data.maxShowTabs);Light.refreshTextFontSize();if(d.length>0){d.push("responseId="+e);Light.portal.refreshPortalHeader();Light.ajax.sendRequest(Light._CHANGE_GENERAL,{parameters:d.join("&"),onSuccess:Light.saveOptionHandler})}};Light.defaultGeneral=function(b){Light.portal.data.fontSize=0;Light.portal.data.textFont="";Light.portal.data.textColor="";Light.portal.data.showSearchBar=true;Light.portal.data.portletWindowTransparent=false;Light.portal.data.maxShowTabs=10;document.forms["form_"+b]["ptFontSize"].value=0;document.forms["form_"+b]["showSearchBar"].checked=true;document.forms["form_"+b]["transparent"].checked=false;document.forms["form_"+b]["pcTextFont"].value="";document.forms["form_"+b]["pcTextColor"].value="";var a="textFont=&textColor=&headerHeight=0&fontSize=0&showSearchBar=1&transparent=0&maxShowTabs=10&responseId="+b;Light.portal.refreshPortalHeader();Light.refreshWindowTransparent();Light.refreshTextFontSize();Light.ajax.sendRequest(Light._CHANGE_GENERAL,{parameters:a,onSuccess:Light.saveOptionHandler})};Light.showTheme=function(d,c,a,f){var b={popupName:"showTheme",caption:a,theme:c};createTopPopupDiv("showTheme","showTheme.jst",500,b,d,f)};Light.hideTheme=function(){hideTopPopupDiv("showTheme")};Light.selectTheme=function(a){Light.themeLink=Light.newElement({element:"link",rel:"stylesheet",type:"text/css",href:Light.getThemePath(a)+((document.all)?"/MSIE":"")+"/theme.css"});document.getElementsByTagName("head")[0].insertBefore(Light.themeLink,document.getElementsByTagName("link")[1])};Light.saveTheme=function(b,d){var g=document.forms["form_"+b]["ptTheme"].length;var e=null;for(var f=0;f<g;f++){if(document.forms["form_"+b]["ptTheme"][f].checked){e=document.forms["form_"+b]["ptTheme"][f].value}}if(Light.themeLink){document.getElementsByTagName("link")[2].href=Light.themeLink.href;document.getElementsByTagName("head")[0].removeChild(Light.themeLink);Light.themeLink=null}var j=null;g=document.forms["form_"+b]["ptRepeat"].length;for(var f=0;f<g;f++){if(document.forms["form_"+b]["ptRepeat"][f].checked){j=document.forms["form_"+b]["ptRepeat"][f].value}}if(Light.portal.data.bgRepeat!=j){Light.portal.data.bgRepeat=j;if(Light.portal.data.bgImage!="no"){var l=Light.portal.data.bgImage;if(l.indexOf("http")<0){l=Light.getContextPath()+Light.portal.data.bgImage}if(Light.portal.data.bgRepeat==1){document.body.style.background="url('"+l+"') no-repeat "+Light.portal.data.bgPosition}else{if(Light.portal.data.bgRepeat==2){document.body.style.background="url('"+l+"') repeat-x right top"}else{if(Light.portal.data.bgRepeat==3){document.body.style.background="url('"+l+"') repeat-y left top"}else{document.body.style.background="url('"+l+"')"}}}}}var k=null;if(Light.portal.data.newBgImage!=null&&Light.portal.data.newBgImage.length>0){k=Light.portal.data.newBgImage}g=document.forms["form_"+b]["ptBg"].length;for(var f=0;f<g;f++){if(document.forms["form_"+b]["ptBg"][f].checked&&document.forms["form_"+b]["ptBg"][f].value!="more"){k=document.forms["form_"+b]["ptBg"][f].value}}if(k&&k!=Light.portal.data.bgImage){Light.portal.data.bgImage=k;if(k!="no"){var l=k;if(k.indexOf("http")<0){l=Light.getContextPath()+k}if(Light.portal.data.bgRepeat==1){document.body.style.background="url('"+l+"') no-repeat "+Light.portal.data.bgPosition}else{if(Light.portal.data.bgRepeat==2){document.body.style.background="url('"+l+"') repeat-x right top"}else{if(Light.portal.data.bgRepeat==3){document.body.style.background="url('"+l+"') repeat-y left top"}else{document.body.style.background="url('"+l+"')"}}}}else{document.body.style.background="#ffffff"}}var h=null;g=document.forms["form_"+b]["ptHeaderRepeat"].length;for(var f=0;f<g;f++){if(document.forms["form_"+b]["ptHeaderRepeat"][f].checked){h=document.forms["form_"+b]["ptHeaderRepeat"][f].value}}if(Light.portal.data.headerRepeat!=h){Light.portal.data.headerRepeat=h;if(Light.portal.data.headerImage!=null){Light.portal.refreshPortalHeader()}}var a=null;if(Light.portal.data.newHeaderImage!=null&&Light.portal.data.newHeaderImage.length>0){a=Light.portal.data.newHeaderImage}g=document.forms["form_"+b]["ptHeader"].length;for(var f=0;f<g;f++){if(document.forms["form_"+b]["ptHeader"][f].checked&&document.forms["form_"+b]["ptHeader"][f].value!="more"){a=document.forms["form_"+b]["ptHeader"][f].value}}if(a){Light.portal.data.headerImage=a}else{Light.portal.data.headerImage="no"}Light.portal.refreshPortalHeader();if((document.forms["form_"+b]["transparent"].checked&&!Light.portal.data.portletWindowTransparent)||(!document.forms["form_"+b]["transparent"].checked&&Light.portal.data.portletWindowTransparent)){Light.portal.data.portletWindowTransparent=!Light.portal.data.portletWindowTransparent;Light.refreshWindowTransparent()}var c="responseId="+b;if(e!=null){c=c+"&theme="+e;Light.portal.data.theme=e}c=c+"&bgRepeat="+j;if(k){c=c+"&bgImage="+k}c=c+"&headerRepeat="+h;if(a){c=c+"&headerImage="+a}if(document.forms["form_"+b]["transparent"].checked){c=c+"&transparent=1"}if(c.length>0){Light.ajax.sendRequest(Light._CHANGE_THEME,{parameters:c,onSuccess:Light.saveOptionHandler})}if(d){Light.closePortlet(b,true)}};Light.showAddUserTag=function(f,h,b,a,c){var d={id:h,objectType:b,objectId:a};if(c){var g=Light.getPortletById(h);if(g!=null){g.parameter=c+"="+a}}createPopupDiv("addUserTag","addUserTag.jst",400,d,f,h)};Light.addUserTag=function(d){var b=d.tag.value;var g=d.id.value;var c=d.objectType.value;var a=d.objectId.value;var f=Light.getPortletById(g);if(f!=null&&b.length>0){var e="tag="+b+"&responseId="+g+"&objectType="+c+"&objectId="+a;Light.ajax.sendRequest(Light._ADD_USER_TAG,{parameters:e,onSuccess:Light.addUserTagHandler})}};Light.addUserTagHandler=function(a){var c=a.responseText;if(c!=null&&c.length>0){var b=Light.getPortletById(c);if(b!=null){b.refresh(false)}}};Light.editTabUrl=function(e){var b=document.forms["form_"+e]["tabId"].value;var a=document.forms["form_"+e]["url"].value;var c="responseId="+e+"&tabId="+b+"&url="+a+"&action=editPageUrl";var d=Light.getPortletById(e);Light.ajax.sendRequestAndUpdate(d.requestUrl,e,{evalScripts:d.allowJS,parameters:c})};function changeTabColumns(d){var b=document.forms["form_"+d]["ptColumns"].value;var c=Light.getPortletById(d);var a="responseId="+d+"&columns="+b;Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:a})}function changeCurrentTabColumns(d){var b=document.forms["form_"+d]["ptColumns"].value;var c=Light.getPortletById(d);var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&columns="+b;Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:a})}function addAutoTab(a){var h=Light.getMessage("LABEL_NEW_TAB");var g="WindowSkin2";var d=3;var i=10;var c="&width0=300&width1=300&width2=300";var b="1";var f="0";var e="title="+encodeURIComponent(h)+"&windowSkin="+g+"&columns="+d+c+"&between="+i+"&closeable="+b+"&defaulted="+f+"&parentId="+a;Light.ajax.sendRequest(Light._ADD_TAB,{parameters:e,onSuccess:responseAddTab})}function addTab(a){var j=document.forms["form_"+a]["ptTitle"].value;var h=document.forms["form_"+a]["ptWindow"].value;var d=parseInt(document.forms["form_"+a]["ptColumns"].value);var k=document.forms["form_"+a]["ptBetween"].value;var c="";for(var f=0;f<d;f++){c+="&width"+f+"="+document.forms["form_"+a]["ptWidth"+f].value}var b="0";if(document.forms["form_"+a]["ptClose"].checked){b="1"}var g="0";if(document.forms["form_"+a]["ptDefault"].checked){g="1"}var e="title="+encodeURIComponent(j)+"&windowSkin="+h+"&columns="+d+c+"&between="+k+"&closeable="+b+"&defaulted="+g;Light.ajax.sendRequest(Light._ADD_TAB,{parameters:e,onSuccess:responseAddTab});Light.closePortlet(a)}function responseAddTab(b){var a=JSON.parse(b.responseText);var c=new LightPortalTab(a[0]);c.insert()}Light.autoChangeTabWidths=function(e){var b=parseInt(document.forms["form_"+e]["ptColumns"].value);var c=parseInt(1000/b);var d=[];for(var a=0;a<b;a++){d.push(c)}document.forms["form_"+e]["ptWidths"].value=d.join(",")};Light.manageTab=function(b){var c=document.forms["form_"+b]["tabId"].value;var p=document.forms["form_"+b]["ptTitle"].value;var o=document.forms["form_"+b]["ptWindow"].value;var e=document.forms["form_"+b]["ptClient"].value;var g=parseInt(document.forms["form_"+b]["ptColumns"].value);var q=document.forms["form_"+b]["ptBetween"].value;var f=document.forms["form_"+b]["ptWidths"].value;var a="0";if(document.forms["form_"+b]["ptClose"].checked){a="1"}var n="0";if(document.forms["form_"+b]["ptDefault"].checked){n="1"}var k=0;var m=document.forms["form_"+b]["ptStatus"].length;for(var l=0;l<m;l++){if(document.forms["form_"+b]["ptStatus"][l].checked){k=parseInt(document.forms["form_"+b]["ptStatus"][l].value)}}var j=0;if(document.forms["form_"+b]["ptFitScreen"].checked){j=1}var d=Light.getCurrentTab();d.label=p;d.client=e;d.isCloseable=a;d.defaulted=n;d.between=parseInt(q);d.widths=f.split(",");d.fitScreen=j;d.privacy=(k>2)?0:1;d.windowSkin=o;var h="title="+encodeURIComponent(p)+"&tabId="+c+"&windowSkin="+o+"&client="+e+"&columns="+g+"&widths="+f+"&between="+q+"&closeable="+a+"&defaulted="+n+"&status="+k+"&fitScreen="+j;Light.ajax.sendRequest(Light._MANAGE_TAB,{parameters:h,onSuccess:manageTabHandler})};function manageTabHandler(){Light.getCurrentTab().reRender()}function addContent(g,a,c){if(Light.hasPermission(Light.permission.PORTAL_CONTENT_ADD)&&Light.getCurrentTab().allowAddContent){Light.e=c;var b=1;var f=Light.getPortletById(g);var d="portletObjectRefName="+a+"&tabId="+Light.getCurrentTab().serverId+"&column="+b;Light.ajax.sendRequest(Light._ADD_CONTENT,{parameters:d,onSuccess:addContentHandler})}else{Light.alert("Sorry, you don't have permission to add content to the current page.")}}function addContentHandler(b){var a=JSON.parse(b.responseText);var c=new PortletWindow(a[0],true)}function showAddAllFeed(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d,popupName:"addAllFeed"};createTopPopupDiv("addAllFeed","addAllFeed.jst",320,a,b,d)}function showAddFeed(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d,popupName:"addFeed"};createTopPopupDiv("addFeed","addFeed.jst",320,a,b,d)}function addFeed(d){var b=document.forms.myFeedForm["pcFeed"].value;var c=Light.getPortletById(d);var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=addFeed&feed="+encodeURIComponent(b);Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:a});hideTopPopupDiv("addFeed")}function showMyFeed(c){var b=Light.getPortletById(c);var a="responseId="+c+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=showMyFeed";Light.ajax.sendRequestAndUpdate(b.requestUrl,c,{evalScripts:b.allowJS,parameters:a})}function hideMyFeed(c){var b=Light.getPortletById(c);var a="responseId="+c+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=hideMyFeed";Light.ajax.sendRequestAndUpdate(b.requestUrl,c,{evalScripts:b.allowJS,parameters:a})}function showAddFeaturedFeed(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d,popupName:"addFeaturedFeed"};createTopPopupDiv("addFeaturedFeed","addFeaturedFeed.jst",300,a,b,d)}function addFeaturedFeed(d){var b=document.forms.myFeaturedFeedForm["pcFeed"].value;var c=Light.getPortletById(d);var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=addFeaturedFeed&feed="+b;Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:a});hideTopPopupDiv("addFeaturedFeed")}function showFeatured(c){var b=Light.getPortletById(c);var a="responseId="+c+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=showFeatured";Light.ajax.sendRequestAndUpdate(b.requestUrl,c,{evalScripts:b.allowJS,parameters:a})}function hideFeatured(c){var b=Light.getPortletById(c);var a="responseId="+c+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=hideFeatured";Light.ajax.sendRequestAndUpdate(b.requestUrl,c,{evalScripts:b.allowJS,parameters:a})}function showAddCategoryFeed(c,f,a){var d=Light.getPortletById(f);if(d==null){return}var b={id:f,tag:a,popupName:"addCategoryFeed"};createTopPopupDiv("addCategoryFeed","addCategoryFeed.jst",300,b,c,f)}function addCategoryFeed(e,a){var c=document.forms.myCategoryFeedForm["pcFeed"].value;var d=Light.getPortletById(e);var b="responseId="+e+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+d.serverId+"&action=addCategoryFeed&tag="+a+"&feed="+c;Light.ajax.sendRequestAndUpdate(d.requestUrl,e,{evalScripts:d.allowJS,parameters:b});hideTopPopupDiv("addCategoryFeed")}function showCategory(c){var b=Light.getPortletById(c);var a="responseId="+c+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=showCategory";Light.ajax.sendRequestAndUpdate(b.requestUrl,c,{evalScripts:b.allowJS,parameters:a})}function hideCategory(c){var b=Light.getPortletById(c);var a="responseId="+c+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=hideCategory";Light.ajax.sendRequestAndUpdate(b.requestUrl,c,{evalScripts:b.allowJS,parameters:a})}function showAddSubCategoryFeed(c,g,a,f){var d=Light.getPortletById(g);if(d==null){return}var b={id:g,tag:a,subtag:f,popupName:"addSubCategoryFeed"};createTopPopupDiv("addSubCategoryFeed","addSubCategoryFeed.jst",300,b,c,g)}function addSubCategoryFeed(f,a,e){var c=document.forms.mySubCategoryFeedForm["pcFeed"].value;var d=Light.getPortletById(f);var b="responseId="+f+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+d.serverId+"&action=addSubCategoryFeed&tag="+a+"&subtag="+e+"&feed="+c;Light.ajax.sendRequestAndUpdate(d.requestUrl,f,{evalScripts:d.allowJS,parameters:b});hideTopPopupDiv("addSubCategoryFeed")}function showSubCategory(d,a){var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=showSubCategory&name="+encodeURIComponent(a);Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:b})}function hideSubCategory(d,a){var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=hideSubCategory&name="+encodeURIComponent(a);Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:b})}function showCategoryContent(d,a){var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=showCategoryContent&name="+encodeURIComponent(a);Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:b})}function hideCategoryContent(d,a){var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=hideCategoryContent&name="+encodeURIComponent(a);Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:c.allowJS,parameters:b})}function configPortlet(b){var m=Light.getPortletById(b);var k=document.forms["form_"+b]["pcTitle"].value;var j=document.forms["form_"+b]["windowSkin"].value;var i=document.forms["form_"+b]["windowStatus"].value;var l=document.forms["form_"+b]["auto"].value;var e=document.forms["form_"+b]["second"].value;var g=document.forms["form_"+b]["showNumber"].value;var c=document.forms["form_"+b]["colspan"].value;var a=document.forms["form_"+b]["marginTop"].value;var n=(m.transparent)?1:0;var h=(m.showIcon)?1:0;var d=document.forms["form_"+b]["pcClient"].value;m.title=k;m.autoRefreshed=(l==1)?true:false;m.periodTime=parseInt(e)*1000;m.showNumber=g;m.colspan=parseInt(c);m.marginTop=parseInt(a);m.client=d;m.reRender(j);m.cancelConfig();var f="responseId="+b+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+m.serverId+"&title="+encodeURIComponent(k)+"&barBgColor="+m.barBgColor+"&barFontColor="+m.barFontColor+"&contentBgColor="+m.contentBgColor+"&textColor="+m.textColor+"&transparent="+n+"&showIcon="+h+"&windowSkin="+j+"&autoRefreshed="+l+"&periodTime="+e+"&showNumber="+g+"&colspan="+c+"&marginTop="+a+"&client="+d+"&windowStatus="+i;Light.ajax.sendRequest(Light._CONFIG_PORTLET,{parameters:f})}function defaultConfigPortlet(d){var c=document.forms["form_"+d]["pcTitle"].value;var b=Light.getPortletById(d);b.title=c;b.barBgColor="";b.barFontColor="";b.contentBgColor="";b.textColor="";b.transparent=false;b.showIcon=true;b.autoRefreshed=false;b.colspan=0;b.client=0;b.periodTime=0;b.windowSkin="";if(!b.reRender()){b.refreshWindow()}b.cancelConfig();var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&title="+encodeURIComponent(c)+"&transparent=0&showIcon=1&autoRefreshed=0&colspan=0&periodTime=0";Light.ajax.sendRequest(Light._CONFIG_PORTLET,{parameters:a,onSuccess:null})}function validateConfigStore(c){var a=c.name.value;var b=c.uri.value;var d;if(a&&b){d=true}else{Light.alert("All * fields are required.");d=false}return d}function validateSignUp(form){var userId=form.email.value;var password=form.password.value;var cpassword=form.confirmPassword.value;var displayName=form.displayName.value;var uri=form.iUri.value;var returnval;if(displayName&&userId&&password&&cpassword&&uri){var filter=eval(Light._PASSWORD_PATTERN);if(!filter.test(password)){Light.alert(Light.getMessage("ERROR_PASSWORD_FORMAT"));return false}if(password!=cpassword){Light.alert(Light.getMessage("ERROR_PASSWORD_NOT_EQUAL"));returnval=false}else{returnval=true}}else{Light.alert("All * fields are required.");returnval=false}if(returnval){Light.deleteCookie(Light._REMEMBERED_USER_ID)}Light.deleteCookie(Light._REMEMBERED_USER_PASSWORD);return returnval}function validateUserId(a,c){if(!validateEmail(a)){document.forms["form_"+c]["email"].value="";document.forms["form_"+c]["email"].focus();Light.alert(Light.getMessage("ERROR_EMAIL_FORMAT"));return false}var b="email="+a+"&responseId="+c;Light.ajax.sendRequest(Light._VALIDATE_USER_ID,{parameters:b,onSuccess:validateUserIdHandler})}function validateEmail(email){var filter=eval(Light._EMAIL_PATTERN);return filter.test(email)}function validateUserIdHandler(a){var b=JSON.parse(a.responseText);if(b.id!=1){document.forms["form_"+b.id]["email"].value="";Light.alert(Light.getMessage("ERROR_EMAIL_DUPLICATED"));document.forms["form_"+b.id]["email"].focus()}}function validateInternalUri(uri,id){var filter=eval(Light._URI_PATTERN);if(!filter.test(uri)){document.forms["form_"+id]["iUri"].value="";document.forms["form_"+id]["iUri"].focus();Light.alert(Light.getMessage("ERROR_URI_FORMAT"));return false}var params="uri="+uri+"&responseId="+id;Light.ajax.sendRequest(Light._VALIDATE_INTERNAL_URI,{parameters:params,asynchronous:true,onSuccess:validateInternalUriHandler})}function validateInternalUriHandler(a){var b=JSON.parse(a.responseText);if(b.id!=1){document.forms["form_"+b.id]["iUri"].value="";Light.alert(Light.getMessage("ERROR_URI_DUPLICATED"));document.forms["form_"+b.id]["iUri"].focus()}}Light.showMoreBgImage=function(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={bgImage:Light.portal.data.bgImage,ok:Light.getMessage("BUTTON_OK"),cancel:Light.getMessage("BUTTON_CANCEL"),id:d};createTopPopupDiv("moreBgImage","moreBgImage.jst",null,a,b,d)};function saveBgImage(d){var a=document.forms.form_moreBgImage["ptBg"].length;var b="";for(var c=0;c<a;c++){if(document.forms.form_moreBgImage["ptBg"][c].checked){b=document.forms.form_moreBgImage["ptBg"][c].value}}Light.portal.data.newBgImage=b;if(b.length>0){var a=document.forms["form_"+d]["ptBg"].length;for(var c=0;c<a;c++){if(document.forms["form_"+d]["ptBg"][c].value="more"){document.forms["form_"+d]["ptBg"][c].checked=true}else{document.forms["form_"+d]["ptBg"][c].checked=false}}}cancelBgImage()}function cancelBgImage(){hideTopPopupDiv("moreBgImage")}Light.showMoreHeaderImage=function(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={headerImage:Light.portal.data.headerImage,ok:Light.getMessage("BUTTON_OK"),cancel:Light.getMessage("BUTTON_CANCEL"),id:d};createTopPopupDiv("moreHeaderImage","moreHeaderImage.jst",null,a,b,d)};function saveHeaderImage(d){var a=document.forms.form_moreHeaderImage["ptHeader"].length;var c="";for(var b=0;b<a;b++){if(document.forms.form_moreHeaderImage["ptHeader"][b].checked){c=document.forms.form_moreHeaderImage["ptHeader"][b].value}}Light.portal.data.newHeaderImage=c;if(c.length>0){var a=document.forms["form_"+d]["ptHeader"].length;for(var b=0;b<a;b++){if(document.forms["form_"+d]["ptHeader"][b].value="more"){document.forms["form_"+d]["ptHeader"][b].checked=true}else{document.forms["form_"+d]["ptHeader"][b].checked=false}}}cancelHeaderImage()}function cancelHeaderImage(){hideTopPopupDiv("moreHeaderImage")}function subscribeChannels(f){var b=document.forms["form_"+f]["channels"].length;var a="";for(var c=0;c<b;c++){if(document.forms["form_"+f]["channels"][c].checked){a+=document.forms["form_"+f]["channels"][c].value+","}}var e=Light.getPortletById(f);var d="responseId="+f+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+e.serverId+"&action=channels&channels="+a;Light.ajax.sendRequestAndUpdate(e.requestUrl,f,{evalScripts:e.allowJS,parameters:d})}function trackRssItem(a,d){var c=Light.getPortletById(d);if(c==null){return}var b="index="+a+"&"+c.parameter+"&responseId="+d+"&portletId="+c.serverId;Light.ajax.sendRequest(Light._TRACK_RSS_ITEM,{parameters:b})}function readRecommendedItem(c,d){var b=Light.getPortletById(d);var a="itemId="+c+"&responseId="+d;Light.ajax.sendRequest(Light._READ_RECOMMENDED_ITEM,{parameters:a})}function readPopItem(c,d){var b=Light.getPortletById(d);var a="itemId="+c+"&responseId="+d;Light.ajax.sendRequest(Light._READ_POP_ITEM,{parameters:a})}function readViewedItem(c,d){var b=Light.getPortletById(d);var a="itemId="+c+"&responseId="+d;Light.ajax.sendRequest(Light._READ_VIEWED_ITEM,{parameters:a})}function popRssItem(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._POP_RSS_ITEM,{parameters:c,onSuccess:responsePopItem})}function popBlogItem(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._POP_BLOG_ITEM,{parameters:c,onSuccess:responsePopItem})}function popYouTubeItem(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._POP_YOUTUBE_ITEM,{parameters:c,onSuccess:responsePopItem})}function popForumItem(c,b,a,g){var f=Light.getPortletById(g);if(f==null){return}var d="index="+b+"&"+f.parameter+"&pageId="+a+"&responseId="+g+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._POP_FORUM_ITEM,{parameters:d,onSuccess:responsePopItem})}function popTopicItem(c,b,a,g){var f=Light.getPortletById(g);if(f){var d="index="+b+"&"+f.parameter+"&pageId="+a+"&responseId="+g+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._POP_TOPIC_ITEM,{parameters:d,onSuccess:responsePopItem})}}function popDeliItem(b,a,f){var d=Light.getPortletById(f);if(d){var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._POP_DELI_ITEM,{parameters:c,onSuccess:responsePopItem})}}function popBookmarkItem(b,a,f){var d=Light.getPortletById(f);if(d){var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._POP_BOOKMARK_ITEM,{parameters:c,onSuccess:responsePopItem})}}function responsePopItem(a){var c=a.responseText;var b={popupName:"popItem"};createPopupDiv("popItem","popItem.jst",280,b,null,c)}function forwardRssToFriend(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._FWD_RSS_FRIEND,{parameters:c,onSuccess:responseForwardToFriend})}function forwardBlogToFriend(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._FWD_BLOG_FRIEND,{parameters:c,onSuccess:responseForwardToFriend})}function forwardYouTubeToFriend(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._FWD_YOUTUBE_FRIEND,{parameters:c,onSuccess:responseForwardToFriend})}function forwardForumToFriend(c,b,a,g){var f=Light.getPortletById(g);if(f==null){return}var d="index="+b+"&"+f.parameter+"&pageId="+a+"&responseId="+g+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._FWD_FORUM_FRIEND,{parameters:d,onSuccess:responseForwardToFriend})}function forwardTopicToFriend(c,b,a,g){var f=Light.getPortletById(g);if(f==null){return}var d="index="+b+"&"+f.parameter+"&pageId="+a+"&responseId="+g+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._FWD_TOPIC_FRIEND,{parameters:d,onSuccess:responseForwardToFriend})}function forwardDeliToFriend(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._FWD_DELI_FRIEND,{parameters:c,onSuccess:responseForwardToFriend})}function forwardBookmarkToFriend(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._FWD_BOOKMARK_FRIEND,{parameters:c,onSuccess:responseForwardToFriend})}function forwardAdToFriend(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light.forwardAdToFriend,{parameters:c,onSuccess:responseForwardToFriend})}function responseForwardToFriend(a){var c=a.responseText;var b={popupName:"forwardToFriend"};createPopupDiv("forwardToFriend","forwardToFriend.jst",280,b,null,c)}function saveToHeader(b,a,f){var d=Light.getPortletById(f);if(d){var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_TO_HEADER,{parameters:c,onSuccess:responseSaveToHeader})}}function responseSaveToHeader(a){var b=a.responseText;Light.portal.data.headerImage=b;Light.portal.refreshPortalHeader()}function saveToBackground(b,a,f){var d=Light.getPortletById(f);if(d){var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_TO_BACKGROUND,{parameters:c,onSuccess:responseSaveToBackground})}}function responseSaveToBackground(b){var a=b.responseText;Light.portal.data.bgImage=a;var c=a;if(a.indexOf("http")<0){c=Light.getContextPath()+a}if(Light.portal.data.bgRepeat==1){document.body.style.background="url('"+c+"') no-repeat "+Light.portal.data.bgPosition}else{document.body.style.background="url('"+c+"')"}}function saveToBookmark(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_TO_BOOKMARK,{parameters:c,onSuccess:responseSaveToBookmark})}function saveToMyPicture(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_TO_MY_PICTURE,{parameters:c,onSuccess:responseSaveToPicture})}function saveBlogToBookmark(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_BLOG_BOOKMARK,{parameters:c,onSuccess:responseSaveToBookmark})}function saveYouTubeToBookmark(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_YOUTUBE_BOOKMARK,{parameters:c,onSuccess:responseSaveToBookmark})}function saveForumToBookmark(c,b,a,g){var f=Light.getPortletById(g);if(f==null){return}var d="index="+b+"&"+f.parameter+"&responseId="+g+"&pageId="+a+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._SAVE_FORUM_BOOKMARK,{parameters:d,onSuccess:responseSaveToBookmark})}function saveTopicToBookmark(c,b,a,g){var f=Light.getPortletById(g);if(f==null){return}var d="index="+b+"&"+f.parameter+"&responseId="+g+"&pageId="+a+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._SAVE_TOPIC_BOOKMARK,{parameters:d,onSuccess:responseSaveToBookmark})}function saveAdToBookmark(b,a,f){var d=Light.getPortletById(f);if(d==null){return}var c="index="+a+"&"+d.parameter+"&responseId="+f+"&portletId="+d.serverId;Light.ajax.sendRequest(Light._SAVE_AD_BOOKMARK,{parameters:c,onSuccess:responseSaveToBookmark})}function responseSaveToBookmark(a){var c=a.responseText;var b={popupName:"saveToBookmark"};createPopupDiv("saveToBookmark","saveToBookmark.jst",280,b,null,c)}function responseSaveToPicture(a){var c=a.responseText;var b={popupName:"saveToPicture"};createPopupDiv("saveToPicture","saveToPicture.jst",280,b,null,c)}function editRssPortlet(b){var n=document.forms["form_"+b]["prFeed"].value;var l=document.forms["form_"+b]["prTitle"].value;var k=document.forms["form_"+b]["prIcon"].value;var a=document.forms["form_"+b]["prUrl"].value;var c=0;var h=document.forms["form_"+b]["prAuto"].length;for(var g=0;g<h;g++){if(document.forms["form_"+b]["prAuto"][g].checked){c=document.forms["form_"+b]["prAuto"][g].value}}var e=document.forms["form_"+b]["prMinute"].value;var f=document.forms["form_"+b]["prShowType"].value;var j=document.forms["form_"+b]["prItems"].value;if(c=="1"&&e=="0"){Light.alert(Light.getMessage("ERROR_MINUTE_RATE"));return}var m=Light.getPortletById(b);m.title=l;m.icon=k;m.url=a;m.parameter="feed="+n;m.mode=Light._VIEW_MODE;m.refreshHeader();m.refreshButtons();m.rememberMode(0);m.lastAction=null;if(c=="1"){m.autoRefreshed=true}else{m.autoRefreshed=false}m.periodTime=e*60000;m.autoRefresh();var d="responseId="+b+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+m.serverId+"&action=edit&title="+l+"&url="+a+"&icon="+k+"&autoRefresh="+c+"&minute="+e+"&showType="+f+"&items="+j+"&feed="+encodeURIComponent(n);Light.ajax.sendRequestAndUpdate(m.requestUrl,b,{evalScripts:m.allowJS,parameters:d})}function keyDownSearchWeather(b,c){var a;if(window.event){keyID=window.event.keyCode}else{keyID=b.which}if(keyID==13){searchWeatherLocation(c)}return !(keyID==13)}function searchWeatherLocation(d){var c=document.forms["form_"+d]["pwLocation"].value;var b=Light.getPortletById(d);var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&locName="+c;Light.ajax.sendRequestAndUpdate(b.requestUrl,d,{evalScripts:b.allowJS,parameters:a})}function selectWeatherLocation(g){var d=document.forms["form_"+g]["pwLocId"].value;if(!d){var a=document.forms["form_"+g]["pwLocId"].length;for(var b=0;b<a;b++){if(document.forms["form_"+g]["pwLocId"][b].checked){d=document.forms["form_"+g]["pwLocId"][b].value}}}var c=document.forms["form_"+g]["pwUnit"].value;var f=Light.getPortletById(g);var e="responseId="+g+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+f.serverId+"&action=select&locId="+d+"&unit="+c;Light.ajax.sendRequestAndUpdate(f.requestUrl,g,{evalScripts:f.allowJS,parameters:e})}function keyDownEditWeather(b,c){var a;if(window.event){keyID=window.event.keyCode}else{keyID=b.which}if(keyID==13){editWeatherLocation(c)}return !(keyID==13)}function editWeatherLocation(d){var c=document.forms["form_"+d]["pwLocation"].value;var b=Light.getPortletById(d);var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&mode=EDIT&locName="+c;Light.ajax.sendRequestAndUpdate(b.requestUrl,d,{evalScripts:b.allowJS,parameters:a})}function refreshTodoPortletTitle(e,a){if(e.title.indexOf("(")>0){var b=e.title.indexOf("(");var c=e.title;e.title=c.substring(0,b);var d=parseInt(c.substring(b+1,c.length));if(!a){a=1}if(parseInt(a)==1){d++}else{d--}e.title=e.title+"("+d+")"}else{e.title=e.title+"(1)"}e.refreshHeader()}function increaseTodoPortletTitle(f,d){if(d==0){var e=Light.getPortletById(f);if(e.title.indexOf("(")>0){var a=e.title.indexOf("(");var b=e.title;e.title=b.substring(0,a);var c=parseInt(b.substring(a+1,b.length));c++;e.title=e.title+"("+c+")"}else{e.title=e.title+"(1)"}e.refreshHeader()}}function decreasePortletTitle(e){var d=Light.getPortletById(e);if(d.title.indexOf("(")>0){var a=d.title.indexOf("(");var b=d.title;d.title=b.substring(0,a);var c=parseInt(b.substring(a+1,b.length));c--;if(c!=0){d.title=d.title+"("+c+")"}d.refreshHeader()}}changeStatus=function(e,b,a){var d=Light.getPortletById(e);var c="responseId="+e+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+d.serverId+"&state="+d.state+"&action=changeStatus&name="+encodeURIComponent(b);Light.ajax.sendRequestAndUpdate(d.requestUrl,e,{method:"post",evalScripts:d.allowJS,parameters:c});refreshTodoPortletTitle(d,a)};function previousItem(d,a){a=parseInt(a)-1;var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&"+c.parameter+"&action=changeStatus&number="+a;Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{method:"post",evalScripts:c.allowJS,parameters:b})}function nextItem(d,a){a=parseInt(a)+1;var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&"+c.parameter+"&action=changeStatus&number="+a;Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{method:"post",evalScripts:c.allowJS,parameters:b})}function editViewerPortlet(g){var c=document.forms["form_"+g]["prFeed"].value;var f=document.forms["form_"+g]["prTitle"].value;var b=document.forms["form_"+g]["prIcon"].value;var a=document.forms["form_"+g]["prUrl"].value;var e=Light.getPortletById(g);e.title=f;e.icon=b;e.url=a;e.parameter="feed="+c;e.refreshHeader();var d="responseId="+g+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+e.serverId+"&action=edit&mode=EDIT&title="+f+"&url="+a+"&icon="+b+"&feed="+c;Light.ajax.sendRequestAndUpdate(e.requestUrl,g,{method:"post",evalScripts:e.allowJS,parameters:d})}function editMyUrl(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d};createPopupDiv("editMyUrl","editMyUrl.jst",280,a,b,d)}function hideEditMyUrl(){var b=Light.getCurrentTabId();var c=document.getElementById("panel_"+b);var a=document.getElementById("editMyUrl");if(a!=null){c.removeChild(a)}}function keyDownSaveMyUrl(b,c){var a;if(window.event){keyID=window.event.keyCode}else{keyID=b.which}if(keyID==13){saveMyUrl(c)}return !(keyID==13)}function saveMyUrl(c){var a=document.forms.editMyUrlForm["uri"].value;if(a==null||a.length==0){Light.alert("please input your desired URI.");return}var b="uri="+a+"&id="+c;Light.ajax.sendRequest(Light._CHECK_MY_URL,{parameters:b,onSuccess:checkMyUrlHandler})}function checkMyUrlHandler(a){var d=JSON.parse(a.responseText);if(d.id=="-1"){Light.alert("this uri is not available, please input another desired URI.");return}if(d.id=="0"){Light.alert("this uri is not allowed, please input another desired URI.");return}var c=Light.confirm("Do you really want to change URL, you only can change one time!");if(!c){return}var b=document.forms.editMyUrlForm["uri"].value;var e="uri="+b+"&id="+d.id;Light.ajax.sendRequest(Light._SAVE_MY_URL,{parameters:e,onSuccess:saveMyUrlHandler})}function saveMyUrlHandler(a){var b=JSON.parse(a.responseText);var c=Light.getPortletById(b.id);c.refresh();hideEditMyUrl()}function editProfilePhoto(b,d){var c=Light.getPortletById(d);if(c!=null){var a={id:d};createPopupDiv("editProfilePhoto","editProfilePhoto.jst",300,a,b,d)}}hideEditProfilePhoto=function(){hidePopupDiv("editProfilePhoto")};hideCropProfilePhoto=function(){hidePopupDiv("cropProfilePhoto")};cropProfilePhoto=function(c,b){var a={id:c,value:b};createPopupDiv("cropProfilePhoto","cropProfilePhoto.jst",800,a,null,c);Light.cropId=c;jQuery("#cropbox_"+c).Jcrop({onSelect:trackCropPhoto,onChange:trackCropPhoto,aspectRatio:1})};function trackCropPhoto(f){Light.crop={x:f.x,y:f.y,w:f.w,h:f.h};var d=100/f.w;var b=100/f.h;var a=jQuery("#cropbox_"+Light.cropId).width();var e=jQuery("#cropbox_"+Light.cropId).height();jQuery("#preview_"+Light.cropId).css({width:Math.round(d*a)+"px",height:Math.round(b*e)+"px",marginLeft:"-"+Math.round(d*f.x)+"px",marginTop:"-"+Math.round(b*f.y)+"px"})}submitCropProfilePhoto=function(b){if(!Light.crop){Light.alert("please select the area of the photo for your profile");return false}var a=[];a.push("responseId="+b);a.push("x="+Light.crop.x);a.push("y="+Light.crop.y);a.push("w="+Light.crop.w);a.push("h="+Light.crop.h);Light.ajax.sendRequest(Light._CROP_PROFILE_PHOTO,{parameters:a.join("&"),onSuccess:submitCropProfilePhotoHandler})};submitCropProfilePhotoHandler=function(a){var b=JSON.parse(a.responseText);var c=Light.getPortletById(b.id);if(c){c.refresh()}hideCropProfilePhoto();Light.crop=null;Light.cropId=null;window.scrollTo(0,0)};setColor=function(e,d,b){var c=Light.getPortletById(e);if(c==null){return}if(d==1){c.barBgColor=b;c.refreshHeader()}if(d==2){c.barFontColor=b;c.refreshHeader()}if(d==3){c.contentBgColor=b;var a=document.forms["form_"+e];a.style.backgroundColor=b}if(d==4){c.textColor=b;c.refreshTextColor()}};switchPortletTransparence=function(c,a){var b=Light.getPortletById(c);if(b==null){return}if(a.checked){b.transparent=true}else{b.transparent=false}b.refreshWindowTransparent()};switchPortletIcon=function(c,a){var b=Light.getPortletById(c);if(b==null){return}if(a.checked){b.showIcon=true}else{b.showIcon=false}b.refreshHeader()};showMyPicture=function(){var a=new PortletPopupWindow(11,280,400,Light.getMessage("MENU_MY_PICTURE"),"icons picture","","myPicturePortlet","/myPicturePortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,true,true,50,false,"","","","");a.refresh();window.scrollTo(0,0)};showMyMusic=function(){var a=new PortletPopupWindow(11,280,600,Light.getMessage("MENU_MY_MUSIC"),"icons music","","myMusicPortlet","/myMusicPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0)};openMyMusicPlayer=function(){var a=Light.getPopupPortletByName("myMusicPortlet");if(a){a.close()}a=new PortletPopupWindow(11,280,320,Light.getMessage("MENU_MY_MUSIC_PLAYER"),"icons music","","myMusicPlayerPortlet","/myMusicPlayerPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","",false,false,true,4,2);a.refresh()};closeMyMusicPlayer=function(){var a=Light.getPopupPortletByName("myMusicPlayerPortlet");if(a){a.close(true)}};showMyFile=function(){if(!Light.isLogin()){Light.portal.latestAction.event=null;Light.portal.latestAction.id=null;Light.portal.latestAction.method="showMyFile";Light.showAllLogin(false);return}var a=new PortletPopupWindow(11,280,600,Light.getMessage("MENU_MY_FILE"),"icons file","","myFilePortlet","/myFilePortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0)};showMyFavorites=function(){var a=new PortletPopupWindow(11,280,400,Light.getMessage("MENU_MY_FAVOURITE"),"icons user","","favouritePortlet","/favouritePortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0)};showMyBlog=function(){var a=new PortletPopupWindow(11,200,500,Light.getMessage("MENU_MY_BLOG"),"icons blog","","blogPortlet","/blogPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0)};showMyViewed=function(){var a=new PortletPopupWindow(11,200,500,Light.getMessage("MENU_MY_VIEWED"),"icons viewed","","myViewedItemPortlet","/myViewedItemPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0)};showMyRecommended=function(){var a=new PortletPopupWindow(11,200,500,Light.getMessage("MENU_MY_RECOMMENDED"),"icons recommended","","recommendedItemPortlet","/recommendedItemPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh();window.scrollTo(0,0)};Light.showSummary=function(j,c,h,i,o){if(typeof o==="undefined"){o=h+""+i}var f=Light.getCurrentTabId();var n=Light.getPortletById(c);if(n==null){return}var m=document.getElementById("panel_"+f);var d=document.getElementById("summaryId");if(d!=null){document.body.removeChild(d)}var a=document.createElement("div");a.id="summaryId";a.name=o;a.style.position="absolute";a.onmouseout=function(){Light.hideSummary()};var l=getMousePositionX(j)+10;var k=getMousePositionY(j)+10;setPosition(a,l,k);a.style.zIndex=Light.maxZIndex+1000;if(Light.cacheStorage[o]){var b=320;if(parseInt(l)+b>document.body.clientWidth){l=parseInt(l)-b-40}a.style.width=b;a.className="portlet-popup";a.innerHTML=Light.cacheStorage[o];if(k<=100){k=100}setPosition(a,l,k)}document.body.appendChild(a);a=null;if(!Light.cacheStorage[o]){var g="index="+i+"&obj="+h+"&"+n.parameter;Light.ajax.sendRequest(Light._GET_OBJECT_DESC,{parameters:g,onSuccess:Light.showSummaryHandler})}};Light.hideSummary=function(){var b=Light.getCurrentTabId();var c=document.getElementById("panel_"+b);var a=document.getElementById("summaryId");if(a!=null){document.body.removeChild(a)}};Light.showSummaryHandler=function(i){var e=i.responseText;var c=Light.getCurrentTabId();var h=document.getElementById("panel_"+c);var d=document.getElementById("summaryId");var g=100;var f=100;if(d!=null){cacheId=d.name;if(!Light.cacheStorage[cacheId]){Light.cacheStorage[cacheId]=e}g=getPositionX(d);f=getPositionY(d);var b=320;if(g+b>document.body.clientWidth){g=g-b-40}document.body.removeChild(d);var a=document.createElement("div");a.id="summaryId";a.style.position="absolute";a.style.width=b;a.className="portlet-popup";a.onmouseout=function(){Light.hideSummary()};a.innerHTML=e;setPosition(a,g,f);a.style.zIndex=Light.maxZIndex+1000;document.body.appendChild(a);a=null}};function showObjectComments(h,c,j,b){if(Light.portal==null){return}var d=Light.getCurrentTabId();var l=document.getElementById("panel_"+d);var f=document.getElementById("objectComments");if(f!=null){document.body.removeChild(f)}var a=document.createElement("div");a.id="objectComments";a.style.position="absolute";var k=120;var i=120;if(window.event){i=event.clientY+document.body.scrollTop}else{i=h.pageY}setPosition(a,k,i);a.style.zIndex=Light.maxZIndex+1000;document.body.appendChild(a);a=null;var g="responseId="+c+"&objectId="+j+"&objectType="+b;Light.ajax.sendRequest(Light._GET_OBJECT_COMMENTS,{parameters:g,onSuccess:showObjectCommentsHandler})}hideObjectComments=function(){var b=Light.getCurrentTabId();var c=document.getElementById("panel_"+b);var a=document.getElementById("objectComments");if(a!=null){document.body.removeChild(a)}};function showObjectCommentsHandler(e){var g=e.responseText;var d=Light.getCurrentTabId();var f=document.getElementById("panel_"+d);var c=document.getElementById("objectComments");var a=120;var h=120;if(c!=null){a=getPositionX(c);h=getPositionY(c);document.body.removeChild(c);var b=document.createElement("div");b.id="objectComments";b.style.position="absolute";b.style.width=800;b.className="portlet-popup3";b.innerHTML=g;setPosition(b,a,h);b.style.zIndex=Light.maxZIndex+1000;document.body.appendChild(b);b=null}}function popBlog(b,a){var c="&blogId="+b+"&responseId="+a;Light.ajax.sendRequest(Light._POP_BLOG,{parameters:c,onSuccess:responsePopBlog})}function responsePopBlog(a){Light.alert("This Blog has been Poped.")}function addObjectComment(f,i,a,b,h,c){if(!h){h=0}var d={id:i,objectId:a,objectType:b,parentId:h,popupName:"objectComment"};if(c){var g=Light.getPortletById(i);if(g!=null){g.parameter=c+"="+a}}createPopupDiv("objectComment","objectComment.jst",400,d,f,i)}saveObjectComment=function(g){var f=document.forms["objectCommentForm_"+g]["comment"].value;if(!f){Light.alert("Please input comment first.");return}var a=document.forms["objectCommentForm_"+g]["objectId"].value;var b=document.forms["objectCommentForm_"+g]["objectType"].value;var e=document.forms["objectCommentForm_"+g]["parentId"].value;var d=Light.getPortletById(g);if(d!=null){d.parameter="itemId="+a;var c="&comment="+escape(encodeURIComponent(f))+"&objectId="+a+"&objectType="+b+"&parentId="+e+"&responseId="+g;Light.ajax.sendRequest(Light._SAVE_OBJECT_COMMENT,{parameters:c,onSuccess:saveObjectCommentHandler})}};function saveObjectCommentHandler(a){var b=JSON.parse(a.responseText);var c=Light.getPortletById(b.id);if(c){if(c.lastAction){c.lastAction="&parameter="+b.objectId}else{if(c.parameter){c.parameter="&parameter="+b.objectId}else{c.parameter=b.objectId}}c.refresh(false)}hidePopupDiv("objectComment");if(b.status==0){Light.alert(L$("MESSAGE_COMMENT_NEED_APPROVE").title)}}function popAd(a,b){var c="&adId="+a+"&responseId="+b;Light.ajax.sendRequest(Light._POP_AD,{parameters:c,onSuccess:popAdHandler})}function popAdHandler(a){Light.alert("This Ad has been Poped.")}function validateGroup(d){var a=d.displayName.value;var c=d.iUri.value;var b=d.shortDesc.value;var e;if(a&&c&&b){e=true}else{Light.alert("All * fields are required.");e=false}return e}function joinToGroup(c,b,a){if(!Light.isLogin()){Light.portal.latestAction.event=c;Light.portal.latestAction.id=a;Light.portal.latestAction.groupId=b;Light.portal.latestAction.method="joinToGroup";Light.showAllLogin(false);return}if(b==null){if(Light.portal.latestAction.groupId!=null){b=Light.portal.latestAction.groupId}else{b=0}}var d="groupId="+b+"&responseId="+a;Light.ajax.sendRequest(Light._JOIN_TO_GROUP,{parameters:d,onSuccess:joinToGroupHandler})}function joinToGroupHandler(a){var c=a.responseText.split(";");if(c[0]=="1"){var b={popupName:"joinToGroup"};createPopupDiv("joinToGroup","joinToGroup1.jst",280,b,null,c[1])}if(c[0]=="2"){var b={popupName:"joinToGroup"};createPopupDiv("joinToGroup","joinToGroup2.jst",280,b,null,c[1])}if(c[0]=="0"){var b={popupName:"joinToGroup"};createPopupDiv("joinToGroup","joinToGroup0.jst",280,b,null,c[1])}}function selectInvitedFriends(g){var b=document.forms["form_"+g]["from"];if(b.length==-1){Light.alert("There are no friends which can be removed from invited list!")}else{var e=b.selectedIndex;if(e==-1){Light.alert("You must select an friend to be removed!")}else{newValue=b.options[e].value;newText=b.options[e].text;var f=new Array(b.length-1);var d=new Array(b.length-1);for(var c=0;c<b.length;c++){if(c<e){f[c]=b.options[c].text}if(c>e){f[c-1]=b.options[c].text}if(c<e){d[c]=b.options[c].value}if(c>e){d[c-1]=b.options[c].value}}b.length=f.length;for(c=0;c<f.length;c++){b.options[c].value=d[c];b.options[c].text=f[c]}var a=document.forms["form_"+g]["to"].length++;document.forms["form_"+g]["to"].options[a].value=newValue;document.forms["form_"+g]["to"].options[a].text=newText}}}function unselectInvitedFriends(g){var b=document.forms["form_"+g]["to"];if(b.length==-1){Light.alert("There are no friends which can be removed from invited list!")}else{var e=b.selectedIndex;if(e==-1){Light.alert("You must select an friend to be removed!")}else{newValue=b.options[e].value;newText=b.options[e].text;var f=new Array(b.length-1);var d=new Array(b.length-1);for(var c=0;c<b.length;c++){if(c<e){f[c]=b.options[c].text}if(c>e){f[c-1]=b.options[c].text}if(c<e){d[c]=b.options[c].value}if(c>e){d[c-1]=b.options[c].value}}b.length=f.length;for(c=0;c<f.length;c++){b.options[c].value=d[c];b.options[c].text=f[c]}var a=document.forms["form_"+g]["from"].length++;document.forms["form_"+g]["from"].options[a].value=newValue;document.forms["form_"+g]["from"].options[a].text=newText}}}function inviteToGroup(d,g){var f="groupId="+document.forms["form_"+g]["groupId"].value+"&responseId="+g;var a=document.forms["form_"+g]["to"].length;if(a<=0){Light.alert("You have to choose your friends first.");return}var c="";for(var b=0;b<a;b++){c+=document.forms["form_"+g]["to"][b].value+";"}f+="&friends="+c;Light.ajax.sendRequest(Light._INVITE_TO_GROUP,{parameters:f,onSuccess:responseInviteToGroup})}function responseInviteToGroup(a){var d=a.responseText.split(";");var b={friendsName:d[0],popupName:"inviteToGroup"};createPopupDiv("inviteToGroup","inviteToGroup.jst",280,b,null,d[1]);var c=Light.getPortletById(d[1]);if(c!=null){c.close(true)}}function viewGroupPictures(b,a,d){var c=new PortletPopupWindow(11,300,400,Light.getMessage("MENU_GROUP_PICTURES"),"icons picture","","groupPicturePortlet","/groupPicturePortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,true,true,10000,false,"","","","groupId="+a);c.refresh()}function viewGroupMembers(b,a,d){var c=new PortletPopupWindow(11,300,400,Light.getMessage("MENU_GROUP_MEMBERS"),"icons user","","groupMembersPortlet","/groupMembersPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","groupId="+a);c.refresh()}function viewGroupBulletins(b,a,d){var c=new PortletPopupWindow(11,300,400,Light.getMessage("MENU_GROUP_BULLETIN"),"icons bulletin","","groupBulletinPortlet","/groupBulletinPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","groupId="+a);c.refresh()}function inviteOthers(b,a,d){var c=new PortletPopupWindow(11,300,400,Light.getMessage("MENU_GROUP_INVITE"),"icons user","","groupInvitePortlet","/groupInvitePortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","groupId="+a);c.refresh()}function resign(c,a,d){var b={popupName:"resign",id:d,groupId:a};createPopupDiv("resign","resign.jst",280,b,c,d)}function resignGroup(b,a){var c="groupId="+b+"&responseId="+a;Light.ajax.sendRequest(Light._RESIGN_GROUP,{parameters:c,onSuccess:responseResignGroup})}function editGroupProfile(b,a,d){var c=new PortletPopupWindow(11,300,500,Light.getMessage("MENU_GROUP_EDIT"),"icons group","","groupEditPortlet","/groupEditPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","groupId="+a);c.refresh()}function deleteGroupProfile(d,b,a,f){var c={popupName:"deleteGroupProfile",id:f,groupId:b,groupName:a};createPopupDiv("deleteGroupProfile","deleteGroupProfile.jst",280,c,d,f)}function confirmDeleteGroupProfile(b,a){var c="&groupId="+b+"&responseId"+a;Light.ajax.sendRequest(Light._DELETE_GROUP_PROFILE,{parameters:c,onSuccess:responseDeleteGroupProfile})}function showInstantMessageMember(c,b,a){var d="&userId="+b+"&responseId"+a;Light.ajax.sendRequest(Light._CHAT_WITH_MEMBER,{parameters:d,onSuccess:responseChatWithMember})}responseChatWithMember=function(b){var a=b.responseText.split(",");if(a[1]==0){var c={userName:a[0],popupName:"isBlockUser"};createPopupDiv("isBlockUser","isBlockUser.jst",360,c,null,null);return}if(a[1]=="n"){var c={userName:a[0],popupName:"noIM"};createPopupDiv("noIM","noIM.jst",360,c,null,null);return}if(a[1]=="f"){var c={userName:a[0],popupName:"friendOnlyIM"};createPopupDiv("friendOnlyIM","friendOnlyIM.jst",360,c,null,null);return}var g=Light.getCurrentTab();var e=new PortletChatWindow(12,200,300,Light.getMessage("TITLE_CHAT")+a[0],"","","chattingPortlet","/chattingPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,true,false,5000,true,"","","","chattingId="+a[1]);var f=e.id;var d="responseId="+f+"&tabId="+g.serverId+"&portletId="+e.serverId+"&"+e.parameter;Light.ajax.sendRequestAndUpdate(e.requestUrl,f,{evalScripts:e.allowJS,parameters:d});document.forms["form_"+e.id]["chat"].focus()};showSendMessageMember=function(f,a,d,c){var b={id:f,popupName:"sendMessage",buddyId:a,buddyName:d};createPopupDiv("sendMessage","sendMessage.jst",400,b,c,f)};viewPicture=function(h,c,b,f,d,a){picSpan=document.getElementById("picture_"+h);var e={id:h,url:Light.getContextPath()+c,caption:b,width:d,height:a};var g=Light.getPortletById(h);g.parameter="pictureId="+f;picSpan.innerHTML=TrimPath.processDOMTemplate("viewPicture.jst",e)};function createPopupPic(a,o,d,h,i,c){var f=document.getElementById(a);if(f!=null){hidePopupDiv(a)}var g=Light.getCurrentTabId();var m=document.getElementById("panel_"+g);var b=document.createElement("div");b.id=a;b.style.position="absolute";b.className="portlet-popup4";if(d!=null){b.style.width=d}var n=Light.getPortletById(c);if(n.myPictures[h.url]!=null){n.myPictures[h.url].width=h.width;n.myPictures[h.url].height=h.height;n.myPictures[h.url].style.cursor="url('light/images/zoomout.cur'), pointer";b.appendChild(n.myPictures[h.url]);b.innerHTML+="<br/>"+h.caption}else{b.innerHTML=TrimPath.processDOMTemplate(o,h)}var l=200;var k=200;if(window.event){l=event.clientX+document.body.scrollLeft+10;k=event.clientY+document.body.scrollTop-300}else{if(i!=null){l=i.pageX+10;k=i.pageY-300}else{if(c!=null){n=Light.getPortletById(c);l=n.left+100;k=n.top+50}}}if(parseInt(l)+d>document.body.clientWidth){l=parseInt(l)-d-150}if(l<0){l=200}setPosition(b,l,k);var n=null;var j=Light.maxZIndex+1000;b.style.zIndex=j;b.onclick=function(p){hidePopupDiv(a)};m.appendChild(b);b=null}viewMaxPictureAtClient=function(h,a,c,g,k,b,j,o){var n=new Object();if(o){var m=o.split("-");for(var f=0;f<m.length;f++){var l=m[f].split("+");n[f]=new Object();n[f].id=l[0];n[f].positionX=l[1];n[f].positionY=l[2]}}var d={id:a,pictureId:c,url:g,caption:k,width:b,height:j,tags:(o)?n:"",popupName:"viewMaxPicture"};createPopupPic("viewMaxPicture","viewMaxPicture.jst",b,d,h,a)};viewMaxPictureAtClientById=function(g,a){var h=Light.getPortletById(a);var f=document.getElementById("userPicture_"+h.myPictureIndex);var b=f.name.split(";");var k=b[6];var l=new Object();var m=k.split("-");for(var d=0;d<m.length;d++){var j=m[d].split("+");l[d]=new Object();l[d].id=j[0];l[d].positionX=j[1];l[d].positionY=j[2]}var c={id:a,url:b[5],caption:f.value,width:b[3],height:b[4],tags:l,popupName:"viewMaxPicture"};createPopupPic("viewMaxPicture","viewMaxPicture.jst",b[3],c,g,a)};viewGroupPicture=function(a,d,f,i,c,b,h){picSpan=document.getElementById("picture_"+a);var e={id:a,url:Light.getContextPath()+f,caption:i,width:b,height:h};var g=Light.getPortletById(a);g.parameter="pictureId="+c+"&groupId="+d;picSpan.innerHTML=TrimPath.processDOMTemplate("viewPicture.jst",e)};viewMaxGroupPictureAtClient=function(h,a,c,g,k,b,j,o){var n=new Object();var m=o.split("-");for(var f=0;f<m.length;f++){var l=m[f].split("+");n[f]=new Object();n[f].id=l[0];n[f].positionX=l[1];n[f].positionY=l[2]}var d={id:a,pictureId:c,url:Light.getContextPath()+g,caption:k,width:b,height:j,tags:n,mode:0,popupName:"viewMaxPicture"};createPopupPic("viewMaxPicture","viewMaxPicture.jst",b,d,h,a)};saveNote=function(c){var a=document.forms["form_"+c]["content"].value;var b="content="+encodeURIComponent(a);Light.ajax.sendRequest(Light._SAVE_NOTE,{parameters:b,onSuccess:null})};changeNoteRow=function(d,h){var b=document.forms["form_"+h]["content"];var c=b.value;var g=parseInt(c.length/b.cols);for(var a=0;a<c.length;a++){if(c.charAt(a)=="\n"){g++}}b.rows=g+2;var f=Light.getPortletById(h);Light.getCurrentTab().repositionPortlets(f)};function configNote(h){var g=document.forms["form_"+h]["pcTitle"].value;var f=document.forms["form_"+h]["pcBarBgColor"].value;var a=document.forms["form_"+h]["pcBarFontColor"].value;var b=document.forms["form_"+h]["pcContentBgColor"].value;var d=document.forms["form_"+h]["pcTextColor"].value;var e=Light.getPortletById(h);e.title=g;e.barBgColor=f;e.barFontColor=a;e.contentBgColor=b;e.refreshWindow();e.mode=Light._VIEW_MODE;e.refreshButtons();var c="responseId="+h+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+e.serverId+"&action=config&title="+encodeURIComponent(g)+"&barBgColor="+f+"&barFontColor="+a+"&contentBgColor="+b+"&textColor="+d;Light.ajax.sendRequestAndUpdate(e.requestUrl,h,{evalScripts:e.allowJS,parameters:c})}function resetNote(d){var c=document.forms["form_"+d]["pcTitle"].value;var b=Light.getPortletById(d);b.title=c;b.barBgColor="";b.barFontColor="";b.contentBgColor="";b.refreshWindow();b.mode=Light._VIEW_MODE;b.refreshButtons();var a="responseId="+d+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+b.serverId+"&action=reset&title="+encodeURIComponent(c);Light.ajax.sendRequestAndUpdate(b.requestUrl,d,{evalScripts:b.allowJS,parameters:a})}function changeEmailConfig(a){if(a.incomingType.value=="pop3"){if(a.incomingSSL.checked){a.incomingPort.value=995}else{a.incomingPort.value=110}}else{if(a.incomingSSL.checked){a.incomingPort.value=993}else{a.incomingPort.value=143}}if(a.outgoingSSL.checked){a.outgoingPort.value=465}else{a.outgoingPort.value=25}}function popupToDo(b){var a=new PortletPopupWindow(11,150,400,Light.getMessage("MENU_TODO"),"icons todolist","","todoListPortlet","/todoListPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh()}function popupCalendar(b){var a=new PortletPopupWindow(11,150,600,Light.getMessage("MENU_CALENDAR"),"icons calendar","","calendarPortlet","/calendarPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");a.refresh()}function validateCalendarEvent(a){if(a.name.value==null||a.name.value.length<=0){Light.alert(" Please input event name first.");return false}else{return true}}function validateForumReply(a){if(a.newTopic.value==1&&(a.topic.value==null||a.topic.value.length<=0)){Light.alert(" Please input topic first.");return false}if(a.content.value==null||a.content.value.length<=0){Light.alert(" Please input content first.");return false}return true}function validateMessage(a){if(a.subject.value==null||a.subject.value.length<=0){Light.alert(" Please input message subject first.");return false}else{return true}}function validateTodo(a){if(a.name.value==null||a.name.value.length<=0){Light.alert(" Please input event name first.");return false}else{return true}}function validateBlogAction(b){if(document.pressed=="delete"){var a=Light.confirm(Light.getMessage("DELETE_BLOG"));if(!a){return false}else{return true}}return true}function editPortletRef(e){var b=document.forms["form_"+e]["refs"];var a=b.length;for(var c=0;c<a;c++){if(b.options[c].selected){aText=b.options[c].text;aValue=b.options[c].value;var d=Light.getPortletById(e);Light.ajax.sendRequest(d.requestUrl,"responseId="+e,"tabId="+Light.getCurrentTab().serverId,"portletId="+d.serverId,"mode=edit","name="+aValue);break}}}function beforeUpload(b){var a=Light.getPortletById(b);a.rememberMode(0);return true}function startCallback(b){var a=Light.getPortletById(b);if(a){a.mode=Light._VIEW_MODE;a.refreshButtons();a.lastAction=null}return true}function completeCallback(c,a){var b=Light.getPortletById(c);if(b!=null){if(b.name=="profilePortlet"){cropProfilePhoto(c,a)}else{Light.executeRender(c,"view","normal","")}}hideEditProfilePhoto();hideTopPopupDiv("addFeed");hideTopPopupDiv("addAllFeed");hideTopPopupDiv("addDealFeed")}Light.addKeywords=function(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d,popupName:"addKeywords"};createPopupDiv("addKeywords","addKeywords.jst",500,a,b,d)};Light.saveKeywords=function(e,c){var b=c.keywords.value;if(b!=null&&b.length>0){var d=Light.getPortletById(e);if(d!=null){var a="responseId="+e+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+d.serverId+"&action=saveKeywords&words="+b;Light.ajax.sendRequestAndUpdate(d.requestUrl,e,{evalScripts:d.allowJS,parameters:a})}hidePopupDiv("addKeywords")}else{Light.alert("Please input keywords first.")}};Light.addNotKeywords=function(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d,popupName:"addNotKeywords"};createPopupDiv("addNotKeywords","addNotKeywords.jst",500,a,b,d)};Light.saveNotKeywords=function(e,b){var d=b.words.value;if(d!=null&&d.length>0){var c=Light.getPortletById(e);if(c!=null){var a="responseId="+e+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=saveNotKeywords&words="+d;Light.ajax.sendRequestAndUpdate(c.requestUrl,e,{evalScripts:c.allowJS,parameters:a})}hidePopupDiv("addNotKeywords")}else{Light.alert("Please input non keywords first.")}};Light.addNotWords=function(b,d){var c=Light.getPortletById(d);if(c==null){return}var a={id:d,popupName:"addNotWords"};createPopupDiv("addNotWords","addNotWords.jst",500,a,b,d)};Light.saveNotWords=function(e,b){var d=b.words.value;if(d!=null&&d.length>0){var c=Light.getPortletById(e);if(c!=null){var a="responseId="+e+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+c.serverId+"&action=saveNotWords&words="+d;Light.ajax.sendRequestAndUpdate(c.requestUrl,e,{evalScripts:c.allowJS,parameters:a})}hidePopupDiv("addNotWords")}else{Light.alert("Please input non words first.")}};Light.keyDownLogin=function(b,c){var a;if(window.event){keyID=window.event.keyCode}else{keyID=b.which}if(keyID==13){Light.loginPortal(c)}return !(keyID==13)};Light.keyDownLoginTo=function(b,c){var a;if(window.event){keyID=window.event.keyCode}else{keyID=b.which}if(keyID==13){Light.loginToPortal(c)}return !(keyID==13)};deleteCalendarEvent=function(h,d,c){var b=Light.confirm(Light.getMessage("COMMAND_DELETE_CALENDAR_EVENT"));if(!b){return}var e=Light.getPortletById(h);var g=d;if(c!=0){var f=Light.confirm(Light.getMessage("COMMAND_DELETE_CALENDAR_EVENTS"));if(f){g+="-"+c}}var a="responseId="+h+"&tabId="+Light.getCurrentTab().serverId+"&portletId="+e.serverId+"&action=delete&parameter="+g;Light.ajax.sendRequestAndUpdate(e.requestUrl,h,{evalScripts:e.allowJS,parameters:a})};Light.stopMusic=function(a){if(Light.music!=null){document.body.removeChild(Light.music);Light.music=null}};Light.checkMusic=function(a){};nextSlideShow=function(g,c){stopSlideShow(g);var f=Light.getPortletById(g);var b=document.getElementById("picture_"+g);b.innerHTML="";if(f.myGroupPictureName!=null){f.myGroupPictureIndex++;if(f.myGroupPictureIndex>=f.myGroupPictureCount){f.myGroupPictureIndex=0}var a=document.getElementById(f.myGroupPictureName+"_"+f.myGroupPictureIndex);var e=a.name.split(";");f.parameter="pictureId="+e[0];var d={id:g,pictureId:e[0],width:e[1],height:e[2],url:e[3],tagging:e[6],caption:a.value};if(f.myPictures[d.url]==null){f.myPictures[d.url]=new Image(d.width,d.height);f.myPictures[d.url].id="currentMyPicture_"+g;f.myPictures[d.url].src=d.url;f.myPictures[d.url].className="portlet2";f.myPictures[d.url].style.border="0px"}b.innerHTML="";if(f.myPictures[d.url]!=null){f.myPictures[d.url].width=d.width;f.myPictures[d.url].height=d.height;f.myPictures[d.url].style.cursor="";b.appendChild(f.myPictures[d.url]);b.innerHTML+="<br/>"+d.caption}else{b.innerHTML=TrimPath.processDOMTemplate("slidePicture.jst",d)}}else{f.myPictureIndex++;if(f.myPictureIndex>=c){f.myPictureIndex=0}var a=document.getElementById("pictures_"+f.myPictureIndex);var e=a.name.split(";");f.parameter="pictureId="+e[0];var d={id:g,pictureId:e[0],width:e[1],height:e[2],url:e[3],tagging:e[6],caption:a.value};if(f.myPictures[d.url]==null){f.myPictures[d.url]=new Image(d.width,d.height);f.myPictures[d.url].id="currentMyPicture_"+g;f.myPictures[d.url].src=d.url;f.myPictures[d.url].className="portlet2";f.myPictures[d.url].style.border="0px"}if(f.myPictures[d.url]!=null){f.myPictures[d.url].width=d.width;f.myPictures[d.url].height=d.height;f.myPictures[d.url].style.cursor="";b.appendChild(f.myPictures[d.url]);b.innerHTML+="<br/>"+d.caption}else{b.innerHTML=TrimPath.processDOMTemplate("slidePicture.jst",d)}}Light.getCurrentTab().repositionFooter()};previousSlideShow=function(g,c){stopSlideShow(g);var f=Light.getPortletById(g);var b=document.getElementById("picture_"+g);b.innerHTML="";if(f.myGroupPictureName!=null){f.myGroupPictureIndex--;if(f.myGroupPictureIndex<0){f.myGroupPictureIndex=f.myGroupPictureCount-1}var a=document.getElementById(f.myGroupPictureName+"_"+f.myGroupPictureIndex);var e=a.name.split(";");f.parameter="pictureId="+e[0];var d={id:g,pictureId:e[0],width:e[1],height:e[2],url:e[3],tagging:e[6],caption:((a.value)?a.value:"")};if(f.myPictures[d.url]==null){f.myPictures[d.url]=new Image(d.width,d.height);f.myPictures[d.url].id="currentMyPicture_"+g;f.myPictures[d.url].src=d.url;f.myPictures[d.url].className="portlet2";f.myPictures[d.url].style.border="0px"}if(f.myPictures[d.url]!=null){f.myPictures[d.url].width=d.width;f.myPictures[d.url].height=d.height;f.myPictures[d.url].style.cursor="";b.appendChild(f.myPictures[d.url]);b.innerHTML+="<br/>"+d.caption}else{b.innerHTML=TrimPath.processDOMTemplate("slidePicture.jst",d)}}else{f.myPictureIndex--;if(f.myPictureIndex<0){f.myPictureIndex=c-1}var a=document.getElementById("pictures_"+f.myPictureIndex);var e=a.name.split(";");f.parameter="pictureId="+e[0];var d={id:g,pictureId:e[0],width:e[1],height:e[2],url:e[3],tagging:e[6],caption:((a.value)?a.value:"")};if(f.myPictures[d.url]==null){f.myPictures[d.url]=new Image(d.width,d.height);f.myPictures[d.url].id="currentMyPicture_"+g;f.myPictures[d.url].src=d.url;f.myPictures[d.url].className="portlet2";f.myPictures[d.url].style.border="0px"}if(f.myPictures[d.url]!=null){f.myPictures[d.url].width=d.width;f.myPictures[d.url].height=d.height;f.myPictures[d.url].style.cursor="";b.appendChild(f.myPictures[d.url]);b.innerHTML+="<br/>"+d.caption}else{b.innerHTML=TrimPath.processDOMTemplate("slidePicture.jst",d)}}Light.getCurrentTab().repositionFooter()};startAllSlideShow=function(c,a){stopSlideShow(c);var b=Light.getPortletById(c);b.myGroupPictureName=null;b.myGroupPictureCount=-1;if(!b.autoShow){b.autoShow=true;autoSlideShow(c,a)}};startSlideShow=function(c,a){stopSlideShow(c);var b=Light.getPortletById(c);if(!b.autoShow){b.autoShow=true;if(b.myGroupPictureName!=null){autoGroupSlideShow(c,b.myGroupPictureName,b.myGroupPictureCount)}else{autoSlideShow(c,a)}}};autoSlideShow=function(g,c){var f=Light.getPortletById(g);if(f.autoShow){var b=document.getElementById("picture_"+g);if(f.fade=="out"){f.opacity=f.opacity-1}else{f.opacity=f.opacity+1}if(f.opacity>=100){f.fade="out"}b.style.filter="alpha(opacity="+f.opacity+")";b.style.MozOpacity=f.opacity/100;if(f.opacity<=0){f.fade="in";f.myPictureIndex++;if(f.myPictureIndex>=c){f.myPictureIndex=0}var a=document.getElementById("pictures_"+f.myPictureIndex);var e=a.name.split(";");f.parameter="pictureId="+e[0];var d={width:e[1],height:e[2],url:e[3],caption:((a.value)?a.value:"")};b.innerHTML="";if(f.myPictures[d.url]==null){f.myPictures[d.url]=new Image(d.width,d.height);f.myPictures[d.url].id="currentMyPicture_"+g;f.myPictures[d.url].src=d.url;f.myPictures[d.url].className="portlet2";f.myPictures[d.url].style.border="0px"}if(f.myPictures[d.url]!=null){f.myPictures[d.url].width=d.width;f.myPictures[d.url].height=d.height;f.myPictures[d.url].style.cursor="";b.appendChild(f.myPictures[d.url]);b.innerHTML+="<br/>"+d.caption}else{b.innerHTML=TrimPath.processDOMTemplate("slidePicture.jst",d)}}f.autoShowId=setTimeout((function(){autoSlideShow(g,c)}),50);Light.getCurrentTab().repositionFooter()}};startGroupSlideShow=function(d,a,b){stopSlideShow(d);var c=Light.getPortletById(d);c.myGroupPictureIndex=-1;c.myGroupPictureName=a;c.myGroupPictureCount=b;if(!c.autoShow){c.autoShow=true;autoGroupSlideShow(d,a,b)}};autoGroupSlideShow=function(h,b,d){var g=Light.getPortletById(h);if(g.autoShow){var c=document.getElementById("picture_"+h);if(g.fade=="out"){g.opacity=g.opacity-1}else{g.opacity=g.opacity+1}if(g.opacity>=100){g.fade="out"}c.style.filter="alpha(opacity="+g.opacity+")";c.style.MozOpacity=g.opacity/100;if(g.opacity<=0){g.fade="in";g.myGroupPictureIndex++;if(g.myGroupPictureIndex>=d){g.myGroupPictureIndex=0}var a=document.getElementById(b+"_"+g.myGroupPictureIndex);var f=a.name.split(";");g.parameter="pictureId="+f[0];var e={width:f[1],height:f[2],url:f[3],caption:a.value};c.innerHTML="";if(g.myPictures[e.url]==null){g.myPictures[e.url]=new Image(e.width,e.height);g.myPictures[e.url].id="currentMyPicture_"+h;g.myPictures[e.url].src=e.url;g.myPictures[e.url].className="portlet2";g.myPictures[e.url].style.border="0px"}if(g.myPictures[e.url]!=null){g.myPictures[e.url].width=e.width;g.myPictures[e.url].height=e.height;g.myPictures[e.url].style.cursor="";c.appendChild(g.myPictures[e.url]);c.innerHTML+="<br/>"+e.caption}else{c.innerHTML=TrimPath.processDOMTemplate("slidePicture.jst",e)}}g.autoShowId=setTimeout((function(){autoGroupSlideShow(h,b,d)}),50);Light.getCurrentTab().repositionFooter()}};stopSlideShow=function(c){var b=Light.getPortletById(c);b.fade="out";var a=document.getElementById("picture_"+c);a.style.filter="alpha(opacity=100)";a.style.MozOpacity=1;b.autoShow=false;if(b.autoShowId!=null){clearTimeout(b.autoShowId)}};function refreshAfterConfig(b){var a=Light.getPortletById(b);a.refresh()}function ConfigAllViewedPic(a,k){var n=Light.getPortletById(a);var l=document.getElementById("userCurrentPicture");var c=l.name.split(";");var m={pictureId:c[0],width:c[1],height:c[2],url:c[3],caption:l.value};if(n.myPictures[m.url]==null){n.myPictures[m.url]=new Image(m.width,m.height);n.myPictures[m.url].id="currentMyPicture_"+a;n.myPictures[m.url].src=m.url;n.myPictures[m.url].className="portlet2";n.myPictures[m.url].style.border="0px";n.myPictures[m.url].style.cursor="url('light/images/zoomin.cur'), pointer"}var e=[];for(var f=0;f<k;f++){var h=document.getElementById("pictures_"+f);var c=h.name.split(";");e[f]={pictureId:c[0],width:c[1],height:c[2],url:c[3],status:c[4],tag:c[5],caption:h.value}}var b="";b+="<span title='' width='100%' style='clear: both;display: block; text-align:right;'>";b+="<a href='javascript:;' onclick=\"javascript:hidePopupDiv('configAll');refreshAfterConfig('"+a+"');\">";b+="<img src='light/images/close_on.gif'/></a>";b+="</span>";b+="<table border='0' cellpadding='0' cellspacing='0' width='100%'>";var k=0;for(var d=0;d<e.length;d++){if(n.myPictures[e[d].url]!=null){k++;if(k%3==1){b+="<tr valign='top'>"}b+="<td class='portlet-table-td-left'>";n.myPictures[e[d].url].width=e[d].width/3;n.myPictures[e[d].url].height=e[d].height/3;n.myPictures[e[d].url].style.cursor="";var g=document.createElement("span");g.appendChild(n.myPictures[e[d].url]);b+=g.innerHTML;b+="<br/>";b+="Caption:<br/><input type='text'  id='caption"+d+"' class='portlet-form-input-field' value='"+e[d].caption+"' size='28' onchange=\"ConfigMyPicture('"+a+"','caption"+d+"',"+e[d].pictureId+","+d+');"/>';b+="<br/>";b+="Tag:<br/><input type='text' id='tag"+d+"' class='portlet-form-input-field' value='"+e[d].tag+"' size='28' onchange=\"ConfigMyPicture('"+a+"','tag"+d+"',"+e[d].pictureId+","+d+');"/>';b+="<br/>";b+="Privacy:<br/>";b+="<input type='radio' id='status0"+d+"' name='status"+d+"' value='0' class='portlet-form-radio' onchange=\"ConfigMyPicture('"+a+"','status0"+d+"',"+e[d].pictureId+","+d+');"';if(e[d].status==0){b+=" checked='checked'"}b+=">Only me</input><br/>";b+="<input type='radio' id='status1"+d+"' name='status"+d+"' value='1' class='portlet-form-radio' onchange=\"ConfigMyPicture('"+a+"','status1"+d+"',"+e[d].pictureId+","+d+');"';if(e[d].status==1){b+=" checked='checked'"}b+=">Available to my friends</input><br/>";b+="<input type='radio' id='status2"+d+"' name='status"+d+"' value='2' class='portlet-form-radio' onchange=\"ConfigMyPicture('"+a+"','status2"+d+"',"+e[d].pictureId+","+d+');"';if(e[d].status==2){b+=" checked='checked'"}b+=">Available to members</input><br/>";b+="<input type='radio' id='status4"+d+"' name='status"+d+"' value='4' class='portlet-form-radio' onchange=\"ConfigMyPicture('"+a+"','status4"+d+"',"+e[d].pictureId+","+d+');"';if(e[d].status==4){b+=" checked='checked'"}b+=">Open to public</input><br/>";b+="<span id= 'configPictureHeader"+d+"' width='100%' style='text-align:left; color: #FF0000;'></span>";if(k%3==0){b+="</tr>"}}}if(k>0&&k%3!=0){b+="</tr>"}b+="</table>";createPopupDiv2("configAll",1000,b,a)}function ConfigMyPicture(g,b,d,a){document.getElementById("configPictureHeader"+a).innerHTML="saving";var f=Light.getPortletById(g);f.pictureConfigIndex=a;var c=document.getElementById(b).value;var e="pictureId="+d+"&name="+b+"&value="+c+"&responseId="+g+"&portletId="+f.serverId;Light.ajax.sendRequest(Light._CONFIG_MY_PICTURE,{parameters:e,onSuccess:responseConfigMyPicture})}function responseConfigMyPicture(a){var c=a.responseText;var b=Light.getPortletById(c);document.getElementById("configPictureHeader"+b.pictureConfigIndex).innerHTML="saved successfully";b.autoShowId=setTimeout((function(){resetConfigMyPictureStatus(c)}),1000)}function resetConfigMyPictureStatus(b){var a=Light.getPortletById(b);document.getElementById("configPictureHeader"+a.pictureConfigIndex).innerHTML=""}Light.showInstantMessage=function(a,b){if(!Light.isLogin()){Light.portal.latestAction.event=a;Light.portal.latestAction.id=b;Light.portal.latestAction.method="showInstantMessage";Light.showAllLogin(false);return}chatWithProfile()};chatWithProfile=function(){Light.ajax.sendRequest(Light._CHAT_WITH_PROFILE,{parameters:null,onSuccess:responseChatWithProfile})};responseChatWithProfile=function(b){var a=b.responseText.split(",");if(a[1]==0){var c={userName:a[0],popupName:"isBlockUser"};createPopupDiv("isBlockUser","isBlockUser.jst",360,c,null,null);return}if(a[1]=="n"){var c={userName:a[0],popupName:"noIM"};createPopupDiv("noIM","noIM.jst",360,c,null,null);return}if(a[1]=="f"){var c={userName:a[0],popupName:"friendOnlyIM"};createPopupDiv("friendOnlyIM","friendOnlyIM.jst",360,c,null,null);return}var d=new PortletChatWindow(12,200,300,Light.getMessage("TITLE_CHAT")+a[0],"","","chattingPortlet","/chattingPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,true,false,5000,true,"","","","chattingId="+a[1]);d.refresh();document.forms["form_"+Light.getCurrentTabId()]["chat"].focus()};Light.showSendMessage=function(d,f,a,c){if(!Light.isLogin()){Light.portal.latestAction.event=d;Light.portal.latestAction.id=f;Light.portal.latestAction.buddyId=a;Light.portal.latestAction.buddyName=c;Light.portal.latestAction.method="Light.showSendMessage";Light.showAllLogin(false);return}if(!a){if(Light.portal.latestAction.buddyId){a=Light.portal.latestAction.buddyId}else{a=0}}if(!c&&Light.portal.latestAction.buddyName){c=Light.portal.latestAction.buddyName}var b={id:f,popupName:"sendMessage",buddyId:a,buddyName:c};createPopupDiv("sendMessage","sendMessage.jst",400,b,d,f)};Light.sendMessageAction=function(a,k,j){var b=document.forms["mForm_"+a];var g=b.subject.value;if(!g){Light.alert("Please input subject.");return}var f=b.content.value;if(!f){Light.alert("Please input content.");return}var h=0;var e=b.format.length;for(var d=0;d<e;d++){if(b.format[d].checked){h=parseInt(b.format[d].value)}}var c="responseId="+a+"&toUserId="+k+"&subject="+escape(encodeURIComponent(g))+"&content="+escape(encodeURIComponent(f))+"&format="+h;Light.ajax.sendRequest(Light._SEND_MESSAGE,{method:"post",parameters:c,onSuccess:Light.sendMessageActionHandler});hidePopupDiv(j)};Light.sendMessageActionHandler=function(a){var b={popupName:"responseSendMessageAction",value:a.responseText};createPopupDiv(b.popupName,b.popupName+".jst",280,b,null,null)};Light.showForwardToFriends=function(b,c){if(!Light.isLogin()){Light.portal.latestAction.event=b;Light.portal.latestAction.id=c;Light.portal.latestAction.method="Light.showForwardToFriends";Light.showAllLogin(false);return}var a={id:c,popupName:"forwardToFriends"};createPopupDiv("forwardToFriends","forwardToFriends.jst",280,a,b,c)};Light.saveForwardToFriends=function(b){var a="responseId="+b;Light.ajax.sendRequest(Light._FORWARD_TO_FRIENDS,{parameters:a,onSuccess:Light.saveForwardToFriendsHandler})};Light.saveForwardToFriendsHandler=function(a){var b={popupName:"responseForwardToFriends"};createPopupDiv("responseForwardToFriends","responseForwardToFriends.jst",280,b,null,a.responseText)};Light.showAddToFriend=function(d,f,a,c){if(!Light.isLogin()){Light.portal.latestAction.event=d;Light.portal.latestAction.id=f;Light.portal.latestAction.buddyId=a;Light.portal.latestAction.buddyName=c;Light.portal.latestAction.method="Light.showAddToFriend";Light.showAllLogin(false);return}if(a==null){if(Light.portal.latestAction.buddyId!=null){a=Light.portal.latestAction.buddyId}else{a=0}}if(c==null&&Light.portal.latestAction.buddyName!=null){c=Light.portal.latestAction.buddyName}var b={id:f,popupName:"addToFriend",buddyId:a,buddyName:c};createPopupDiv("addToFriend","addToFriend.jst",360,b,d,f)};Light.saveAddToFriend=function(c,a){var b="responseId="+c+"&buddyId="+a;Light.ajax.sendRequest(Light._ADD_FRIEND,{parameters:b,onSuccess:Light.saveAddToFriendHandler})};Light.saveAddToFriendHandler=function(a){var b={popupName:"responseAddToFriend"};createPopupDiv("responseAddToFriend","responseAddToFriend.jst",280,b,null,a.responseText)};Light.showAddToFavorites=function(b,c){if(!Light.isLogin()){Light.portal.latestAction.event=b;Light.portal.latestAction.id=c;Light.portal.latestAction.method="Light.showAddToFavorites";Light.showAllLogin(false);return}var a={id:c,popupName:"addToFavorites"};createPopupDiv("addToFavorites","addToFavorites.jst",280,a,b,c)};Light.saveAddToFavorites=function(b){var a="responseId="+b;Light.ajax.sendRequest(Light._ADD_TO_FAVORITES,{parameters:a,onSuccess:Light.saveAddToFavoritesHandler})};Light.saveAddToFavoritesHandler=function(a){var b={popupName:"responseAddToFavorites"};createPopupDiv("responseAddToFavorites","responseAddToFavorites.jst",280,b,null,a.responseText)};Light.showRankUser=function(a,c){if(!Light.isLogin()){Light.portal.latestAction.event=a;Light.portal.latestAction.id=c;Light.portal.latestAction.method="Light.showRankUser";Light.showAllLogin(false);return}var b=new PortletPopupWindow(11,300,400,Light.getMessage("MENU_RANK"),"icons rank","","rankPortlet","/rankPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,false,false,0,false,"","","","");b.refresh()};Light.showBlockUser=function(b,c){if(!Light.isLogin()){Light.portal.latestAction.event=b;Light.portal.latestAction.id=c;Light.portal.latestAction.method="Light.showBlockUser";Light.showAllLogin(false);return}var a={id:c,popupName:"blockUser"};createPopupDiv("blockUser","blockUser.jst",280,a,b,c)};Light.saveBlockUser=function(b){var a="responseId="+b;Light.ajax.sendRequest(Light._BLOCK_USER,{parameters:a,onSuccess:Light.saveBlockUserHandler})};Light.saveBlockUserHandler=function(a){var b={popupName:"responseBlockUser"};createPopupDiv("responseBlockUser","responseBlockUser.jst",280,b,null,a.responseText)};function moveSliderBarBegin(f,d,b,c,a){if(d.move!=null&&d.move){return}b.move=true;d.oldLeft=d.style.left;moveSliderBar(f,d,b,c,a)}function moveSliderBar(h,b,a,d,g,i){if(a.move==null||!a.move){return}if(b.move!=null&&b.move){return}var f=0;if(i!=null){f=i}else{f=getMousePositionX(h)}var j=f;f-=getX(a);var c=parseInt(b.style.left);if(f>c){f=c+10}else{f=c-10}if(f<d){f=d}if(f>g){f=g}b.style.left=f+"px";setTimeout((function(){moveSliderBar(h,b,a,d,g,j)}),100)}function moveSliderBarEnd(d,a,c,k,h,g,i,j){if(d.move!=null&&d.move){return}if(a.move!=null&&a.move){a.move=false;var b=parseInt(d.style.left);var l=parseInt((i-g)/h);var f=parseInt((b-g)/l);if(b<=g){newpage=0}else{if(b>=i){f=h-1}else{var e=parseInt(d.oldLeft);if(b<e&&f>=k){f=k-1}if(b>e&&f<=k){f=k+1}}}if(f<0){f=0}if(f>=h){f=h-1}Light.executeRender(c,"","maximized","viewType="+j+";page="+f)}}function moveSliderBegin(c,a,b){a.move=true;a.oldLeft=a.style.left;a.left=(typeof b!="undefined")?b:getMousePositionX(c)}function moveSlider(h,f,d,a){if(f.move==null||!f.move){return}var g=getMousePositionX(h);if(f.left==null){f.left=g}else{var b=g;var c=parseInt(f.style.left);if(g<f.left){g=c-(f.left-g)}else{g=c+(g-f.left)}f.left=b}if(g<d){g=d}if(g>a){g=a}f.style.left=g}function moveSliderEnd(b,a,j,g,f,h,i){if(b.move!=null&&b.move){b.move=false;var c=parseInt(b.style.left);var k=parseInt((h-f)/g);var e=parseInt((c-f)/k);if(c<=f){newpage=0}else{if(c>=h){e=g-1}else{var d=parseInt(b.oldLeft);if(c<d&&e>=j){e=j-1}if(c>d&&e<=j){e=j+1}}}if(e<0){e=0}if(e>=g){e=g-1}Light.executeRender(a,"","maximized","viewType="+i+";page="+e)}}function changeNumber(e,d,c,b,a){if(c<b){moveToRight(d)}else{moveToLeft(d)}Light.executeRender(e,"","maximized","viewType="+a+"&number="+c)}function moveToRight(b){var a=parseInt(b.style.marginLeft);a+=10;b.style.marginLeft=a+"px";setTimeout((function(){moveToRight(b)}),10)}function moveToLeft(b){var a=parseInt(b.style.marginLeft);a-=10;b.style.marginLeft=a+"px";setTimeout((function(){moveToLeft(b)}),10)}function showProgressBar(b){Light.portal.progressBar.style.visibility="visible";Light.portal.progressBar.style.zIndex=Light.maxZIndex+1000;var a=getMousePositionX(b);var c=getMousePositionY(b);if(a<0){a=0}if(c<0){c=0}setPosition(Light.portal.progressBar,a,c);document.body.appendChild(Light.portal.progressBar)}function hideProgressBar(){Light.portal.progressBar.style.visibility="hidden";document.body.removeChild(Light.portal.progressBar)}function responseResignGroup(b){var a=b.responseText;var c=Light.getPortletById(a);if(c!=null){c.refresh()}}function responseDeleteGroupProfile(b){var d=b.responseText.split(";");if(d[0]!=0){var c=Light.getPortletById(d[1]);if(c!=null){c.refresh()}}else{Light.alert("You cannot delete this group, because this group has members.")}var a=b.responseText}createTopPopupDiv=function(a,n,d,h,i,c,j){var g=document.getElementById(a);if(g!=null&&j!=null&&j){hideTopPopupDiv(a)}else{if(g!=null){return}}var f=Light.getCurrentTabId();var b=document.createElement("div");b.id=a;b.style.position="absolute";b.className="portlet-popup";if(d!=null){if(d>Light.portal.layout.maxWidth){d=Light.portal.layout.maxWidth}b.style.width=d}b.innerHTML=TrimPath.processDOMTemplate(n,h);var m=getMousePositionX(i);var l=getMousePositionY(i);if(m<=0){m=getScreenCenterX()-d/2;l=getScreenCenterY()}if(parseInt(m)+d>Light.getScreenWidth()){m=Light.getScreenWidth()-d}setPosition(b,m,l);var k=++Light.maxZIndex+10000;b.style.zIndex=k;document.body.appendChild(b);Light.refreshTextFontSize();b=null};createPopupDiv=function(a,o,d,h,i,c,j){var g=document.getElementById(a);if(g!=null&&j){hidePopupDiv(a)}else{if(g!=null){return}}var f=Light.getCurrentTabId();var n=document.getElementById("panel_"+f);var b=document.createElement("div");b.id=a;b.style.position="absolute";b.className="portlet-popup";if(d!=null){if(d>Light.portal.layout.maxWidth){d=Light.portal.layout.maxWidth}b.style.width=d}b.innerHTML=TrimPath.processDOMTemplate(o,h);var m=getMousePositionX(i);var l=getMousePositionY(i);if(m<=0){m=getScreenCenterX()-d/2;l=getScreenCenterY()}if(parseInt(m)+d>Light.getScreenWidth()){m=Light.getScreenWidth()-d}m=m-Light.portal.layout.containerLeft-Light.portal.layout.bodyLeft;l=l-40;setPosition(b,m,l);var k=++Light.maxZIndex+10000;b.style.zIndex=k;n.appendChild(b);Light.refreshTextFontSize();b=null};createPopupDiv2=function(a,c,g,b){var e=document.getElementById(a);if(e!=null){return}var f=Light.getCurrentTabId();var k=document.getElementById("panel_"+f);var d=document.createElement("div");d.id=a;d.style.position="absolute";d.className="portlet-popup";if(c!=null){if(c>Light.portal.layout.maxWidth){c=Light.portal.layout.maxWidth}d.style.width=c}d.innerHTML=g;var j=20;var i=100;setPosition(d,j,i);var l=null;var h=++Light.maxZIndex+10000;d.style.zIndex=h;k.appendChild(d);Light.refreshTextFontSize();d=null;Light.portal.footer.style.visibility="hidden"};function hideTopPopupDiv(a,g){var c=document.getElementById(a);if(c!=null){var f=getMousePositionX(g);var d=getMousePositionY(g);var i=getX(c);var h=getY(c);var b=c.clientWidth;var j=c.clientHeight;if(f>i&&f<i+b&&d>h&&d<h+j){return}document.body.removeChild(c);document.body.onclick=null;return true}return false}function hidePopupDiv(c){var b=Light.getCurrentTabId();var d=document.getElementById("panel_"+b);var a=document.getElementById(c);if(a!=null){d.removeChild(a);return true}Light.portal.footer.style.visibility="visible";return false}function showDesc(g,f,b){var c=Light.getCurrentTabId();var l=Light.getPortletById(b);if(l==null){return}var k=document.getElementById("panel_"+c);var d=document.getElementById("vDesc");if(d!=null){k.removeChild(d)}var h=document.createElement("div");h.id="vDesc";h.style.position="absolute";h.innerHTML=f;h.onmouseout=function(){hideDesc()};h.style.width=300;h.className="portlet-popup3";var j=getMousePositionX(g)-80;var i=getMousePositionY(g)-68;var a=300;if(parseInt(j)+a>document.body.clientWidth){j=parseInt(j)-a-40}setPosition(h,j,i);h.style.zIndex=Light.maxZIndex+1000;k.appendChild(h);h=null}hideDesc=function(){var b=Light.getCurrentTabId();var c=document.getElementById("panel_"+b);var a=document.getElementById("vDesc");if(a!=null){c.removeChild(a)}};showSocialShare=function(c,d,a){var b={popupName:"socialShare",title:L$(d+"_title").value,link:a};createPopupDiv("socialShare","socialShare.jst",180,b,c)};function showBuddyDetail(b,a,d){var c="userId="+a+"&responseId="+d;Light.ajax.sendRequest(Light._GET_USER_DETAIL,{parameters:c,onSuccess:responseUserDetail})}responseUserDetail=function(a){var b=JSON.parse(a.responseText);var c={title:Light.getMessage("CLOSE"),buttonMessage:Light.getMessage("BUTTON_MESSAGE"),buttonAdd:Light.getMessage("BUTTON_ADD_BUDDY"),buttonChat:Light.getMessage("BUTTON_CHAT"),buttonSave:Light.getMessage("BUTTON_SAVE"),buttonDelete:Light.getMessage("BUTTON_DELETE"),popupName:"buddyDetail",conn:b};createPopupDiv("buddyDetail","connection.detail",400,c)};hideBuddyDetail=function(){hidePopupDiv("buddyDetail")};saveAddBuddy=function(a,c){var b="responseId="+c+"&buddyId="+a;Light.ajax.sendRequest(Light._ADD_FRIEND,{parameters:b,onSuccess:responseSaveAddBuddy})};responseSaveAddBuddy=function(a){var b={title:Light.getMessage("CLOSE"),ok:Light.getMessage("BUTTON_OK"),cancel:Light.getMessage("BUTTON_CANCEL"),popupName:"responseAddToFriend"};createPopupDiv("responseAddToFriend","responseAddToFriend.jst",280,b,null,a.responseText)};saveBuddyType=function(a,d){var b=document.forms["buddyDetail_"+d]["friendType"].value;var c="userId="+a+"&responseId="+d+"&type="+b;Light.ajax.sendRequest(Light._SAVE_BUDDY_TYPE,{parameters:c,onSuccess:responseBuddy})};deleteBuddy=function(a,c){var b="userId="+a+"&responseId="+c;Light.ajax.sendRequest(Light._DELETE_BUDDY,{parameters:b,onSuccess:responseBuddy})};responseBuddy=function(a){hideBuddyDetail();var b=Light.getPortletById(a.responseText);b.refresh()};Light.refreshIframeHeight=function(b){var a=document.getElementById(b).contentDocument.body.scrollHeight;document.getElementById(b).height=a};Light.validateMicroblog=function(c){var a=140-L$(c+"_content").value.length;var b=L$(c+"_counter");b.innerHTML=a;if(a<0){b.style.color="#FF0000"}else{b.style.color="#CCCCCC"}};Light.addMicroblog=function(f){var b=L$(f+"_counter");var a=parseInt(b.innerHTML);if(a<0){Light.alert("Content is over 140 characters.");return}var d=L$(f+"_content");var e=Light.getPortletByName("microblogPortlet");if(e){var c="responseId="+e.id+"&content="+d.value+"&action=add";Light.ajax.sendRequestAndUpdate(e.requestUrl,e.id,{method:"post",evalScripts:e.allowJS,parameters:c});b.innerHTML=140;d.value=""}};Light.configMicroblog=function(d,b){var c=Light.getPortletById(d);if(c!=null){var a="responseId="+c.id+"&type="+b+"&portletId="+c.serverId+"&action=config";Light.ajax.sendRequestAndUpdate(c.requestUrl,c.id,{method:"post",evalScripts:c.allowJS,parameters:a})}};Light.refreshAtClient=function(a){if(a&&a.name=="myPicturePortlet"){Light.refreshMyPicturesAtClient(a)}};Light.afterRefreshAtClient=function(b){var a=Light.getPortletById(b);if(a){Light.getCurrentTab().repositionPortlets(a)}};Light.refreshMyPicturesAtClient=function(k){if(k==null){return}var a=L$("userPictures");if(a==null){return}var i=a.getElementsByTagName("input").length;var b=k.id;var g=L$("picture_"+b);if(g==null){return}if(k.fade=="out"){k.opacity=k.opacity-1}else{k.opacity=k.opacity+1}if(k.opacity>=100){k.fade="out"}g.style.filter="alpha(opacity="+k.opacity+")";g.style.MozOpacity=k.opacity/100;if(k.opacity<=0){k.fade="in";k.myPictureIndex++;if(k.myPictureIndex>=i){k.myPictureIndex=0}var h=L$("userPicture_"+k.myPictureIndex);var d=h.name.split(";");k.parameter="pictureId="+d[0];var e={swidth:d[1],sheight:d[2],lwidth:d[3],lheight:d[4],url:d[5],id:b,pictureId:d[0],caption:h.value};g.innerHTML="";if(k.myPictures[e.url]==null){k.myPictures[e.url]=new Image(e.swidth,e.sheight);k.myPictures[e.url].id="currentMyPicture_"+b;k.myPictures[e.url].src=e.url;k.myPictures[e.url].className="portlet2";k.myPictures[e.url].style.border="0px";k.myPictures[e.url].style.cursor="url('light/images/zoomin.cur'), pointer"}if(k.myPictures[e.url]!=null){k.myPictures[e.url].width=e.swidth;k.myPictures[e.url].height=e.sheight;k.myPictures[e.url].style.cursor="url('light/images/zoomin.cur'), pointer";g.appendChild(k.myPictures[e.url]);g.innerHTML+="<br/>"+e.caption}else{g.innerHTML=Light.getViewTemplate("refreshPicture.jst",e)}setTimeout((function(){Light.afterRefreshAtClient(b)}),500);var f=k.myPictureIndex+1;if(f>=i){f=0}var l=L$("userPicture_"+f);var j=l.name.split(";");var c={swidth:j[1],sheight:j[2],lwidth:j[3],lheight:j[4],url:j[5],id:b,pictureId:j[0],caption:l.value};if(k.myPictures[c.url]==null){k.myPictures[c.url]=new Image(c.swidth,c.sheight);k.myPictures[c.url].id="currentMyPicture_"+b;k.myPictures[c.url].src=c.url;k.myPictures[c.url].className="portlet2";k.myPictures[c.url].style.border="0px";k.myPictures[c.url].style.cursor="url('light/images/zoomin.cur'), pointer"}}};function PortletChatWindow(y,d,r,A,w,f,b,s,o,t,c,m,i,g,q,j,h,z,k,x,e,v,a,u){Light.portal.allPortlets.push(this);this.parent=Light.currentTab;this.window=new WindowSkin21();this.popup=true;this.allowMove=true;this.mode=Light._VIEW_MODE;this.state=Light._NORMAL_STATE;this.tIndex=this.parent.index;this.serverId=Date.parse(new Date());this.id=Light._PR_PREFIX+this.serverId;this.position=y;this.left=(r<Light.portal.layout.maxWidth)?d:0;this.top=(r<Light.portal.layout.maxWidth)?getScreenCenterY()-200:Light.portal.layout.bodyTop;this.width=(r<Light.portal.layout.maxWidth)?r:Light.portal.layout.maxWidth;this.title=A;this.icon=w;this.url=f;this.name=b;this.requestUrl=s;this.closeable=o;this.refreshMode=t;this.editMode=c;this.helpMode=m;this.configMode=i;this.allowMinimized=true;if(v!=null&&!v){this.allowMinimized=false}this.allowMaximized=true;if(a!=null&&!a){this.allowMaximized=false}this.allowPopout=true;if(u!=null&&!u){this.allowPopout=false}this.autoRefreshed=g;this.refreshAtClient=q;this.periodTime=j;this.allowJS=h;this.barBgColor=z;this.barFontColor=k;this.className="portlet-popup";this.contentBgColor="#EEF6FF";if(x!=""){this.contentBgColor=x}this.parameter=e;this.index=this.parent.getPortletIndex(this.position);var n=0;var l=0;var p=0;this.originalTop=this.top;this.originalWidth=this.width;this.originalLeft=this.left;this.parent.portlets[this.position][this.index]=this;this.window.render(this);this.minimized=false;this.maximized=false;this.isPopout=false;this.moveable=false;this.autoRefreshWhenMaximized=true;this.autoShow=false;this.opacity=0;this.fade="in";this.myPictureIndex=0;this.myPictures=[];this.autoShowId=null;this.mouseDownX=0;this.mouseDownY=0;this.refreshPosition();this.focus();if(this.autoRefreshed){this.firstTimeAutoRefreshed=true;this.autoRefresh(this)}}PortletChatWindow.prototype.rememberMode=function(a){};PortletChatWindow.prototype.focus=function(){this.window.focus(this)};PortletChatWindow.prototype.show=function(){this.window.show(this)};PortletChatWindow.prototype.hide=function(){this.window.hide(this)};PortletChatWindow.prototype.moveBegin=function(b){document.body.onselectstart=function(){return false};document.body.ondragstart=function(){return false};if(document.all){b=event}var a=b.clientX;var c=b.clientY;this.focus();this.moveable=true;this.mouseDownX=a;this.mouseDownY=c;this.moveBeginX=a;this.moveBeginY=c;Light.portal.moveTimer=0;this.startMoveTimer(this)};PortletChatWindow.prototype.moveEnd=function(){if(this.moveable){this.moveable=false;this.originalLeft=this.left;this.originalTop=this.top}};PortletChatWindow.prototype.move=function(b){if(this.moveable){var a=b.clientX;var c=b.clientY;this.left+=a-this.mouseDownX;this.top+=c-this.mouseDownY;this.refreshPosition();this.mouseDownX=a;this.mouseDownY=c}};PortletChatWindow.prototype.startMoveTimer=function(a){if(Light.portal.moveTimer>=0&&Light.portal.moveTimer<10){Light.portal.moveTimer++;setTimeout((function(){a.startMoveTimer(a)}),15)}if(Light.portal.moveTimer==10){Light.portal.dragDropPortlet=this;a.refreshPosition()}};PortletChatWindow.prototype.refreshPosition=function(){this.window.position(this);this.focus()};PortletChatWindow.prototype.autoRefresh=function(a){if(a.autoRefreshed){if(a.firstTimeAutoRefreshed){a.firstTimeAutoRefreshed=false}else{a.selfRefresh()}a.timer=setTimeout((function(){a.autoRefresh(a)}),a.periodTime)}};PortletChatWindow.prototype.selfRefresh=function(){if(!this.minimized&&(!this.maximized||this.autoRefreshWhenMaximized)){if(this.mode==Light._VIEW_MODE){this.refresh()}}};PortletChatWindow.prototype.refresh=function(a){var b=this.id;this.refreshAction=true;Light.executeRefresh(b)};PortletChatWindow.prototype.changePosition=function(){var a="responseId="+this.id+"&tabId="+this.parent.serverId+"&portletId="+this.serverId+"&column="+this.position+"&row="+this.index;Light.ajax.sendRequest(Light._CHANGE_POSITION,{parameters:a});this.parent.repositionPortlets(this)};PortletChatWindow.prototype.edit=function(){if(this.editMode){this.mode=Light._EDIT_MODE;var a=this.id;Light.executePortlet(a);this.window.refreshButtons(this)}};PortletChatWindow.prototype.cancelEdit=function(){if(this.editMode){this.mode=Light._VIEW_MODE;var a=this.id;Light.executePortlet(a);this.window.refreshButtons(this)}};PortletChatWindow.prototype.help=function(){if(this.helpMode){this.mode=Light._HELP_MODE;var a=this.id;Light.executePortlet(a);this.window.refreshButtons(this)}};PortletChatWindow.prototype.cancelHelp=function(){if(this.helpMode){this.mode=Light._VIEW_MODE;var a=this.id;Light.executePortlet(a);this.window.refreshButtons(this)}};PortletChatWindow.prototype.config=function(){if(this.configMode){this.mode=Light._CONFIG_MODE;this.window.refreshButtons(this);var a={id:this.id,title:this.title,barBgColor:this.barBgColor,barFontColor:this.barFontColor,contentBgColor:this.contentBgColor,textColor:this.textColor,transparent:this.transparent};Light.setPortletContent(a.id,Light.getViewTemplate("configMode.jst",a));this.refreshButtons()}};PortletChatWindow.prototype.cancelConfig=function(){if(this.configMode){this.mode=Light._VIEW_MODE;var a=this.id;Light.executePortlet(a);this.window.refreshButtons(this)}};PortletChatWindow.prototype.moveCancel=function(){this.buttonIsClicked=true};PortletChatWindow.prototype.moveAllowed=function(){this.buttonIsClicked=false};PortletChatWindow.prototype.moveUp=function(){};PortletChatWindow.prototype.moveDown=function(){};PortletChatWindow.prototype.moveLeft=function(){};PortletChatWindow.prototype.moveRight=function(){};PortletChatWindow.prototype.minimize=function(){this.minimized=!this.minimized;if(this.minimized){this.state=Light._MINIMIZED_STATE;if(this.maximized){this.maximize(false);this.minimized=true}var a="<br/>";this.window.container.innerHTML=a}else{this.state=Light._NORMAL_STATE}this.window.refreshWindow(this);this.parent.repositionPortlets(this);if(!this.minimized){this.refresh()}};PortletChatWindow.prototype.maximize=function(a){this.windowMaximize(a);this.refresh()};PortletChatWindow.prototype.windowMaximize=function(a){this.maximized=!this.maximized;if(!this.maximized){this.state=Light._NORMAL_STATE;this.top=this.originalTop;this.width=this.originalWidth;this.left=this.originalLeft;Light.portal.container.style.zIndex=1;this.parent.showOtherPortlets()}else{this.state=Light._MAXIMIZED_STATE;this.left=Light.portal.layout.maxLeft;this.top=Light.portal.layout.maxTop;this.width=Light.portal.layout.maxWidth;Light.portal.container.style.zIndex=++Light.maxZIndex;Light.portal.body.style.zIndex=++Light.maxZIndex;Light.portal.footer.style.zIndex=++Light.maxZIndex;this.parent.hideOtherPortlets(this)}this.window.maximize(this);this.parent.repositionPortlets(this)};PortletChatWindow.prototype.popout=function(){this.isPopout=!this.isPopout;if(this.isPopout){if(L$("chattingRoomId")==null){var e=document.createElement("var");e.id="chattingRoomId";e.title=this.parameter;document.body.appendChild(e);var d=document.createElement("var");d.id="chattingRoomName";d.title=this.title;document.body.appendChild(d)}else{L$("chattingRoomId").title=this.parameter;L$("chattingRoomName").title=this.title}var c=600;var b=420;var a=getScreenCenterX()-c/2;var f=getScreenCenterY()-b/2;this.chatWindow=window.open(Light.getContextPath()+"/chat.jsp","mywindow","location=0,menubar=0,status=0,resizable=1,width="+c+",height="+b+",screenX="+a+",screenY="+f);this.window.close(this);this.parent.portlets[this.position][this.index]=null}else{}};PortletChatWindow.prototype.close=function(){var a=Light.confirm(Light.getMessage("COMMAND_CLOSE_POPUP_CHAT"));if(!a){return}if(this.maximized){this.windowMaximize()}clearTimeout(this.timer);this.window.close(this);this.parent.portlets[this.position][this.index]=null;this.parent.repositionPortlets(this);this.parent.repositionFooter();Light.ajax.sendRequest(Light._CLOSE_CHAT,{parameters:this.parameter})};PortletChatWindow.prototype.refreshButtons=function(){this.window.refreshButtons(this)};PortletChatWindow.prototype.refreshWindow=function(){this.window.refreshWindow(this)};PortletChatWindow.prototype.refreshHeader=function(){this.window.refreshHeader(this)};PortletChatWindow.prototype.refreshWindowTransparent=function(){};PortletChatWindow.prototype.refreshTextColor=function(){};PortletChatWindow.prototype.getTop=function(){return this.window.top};PortletChatWindow.prototype.getHeight=function(){return this.window.container.clientHeight};PortletChatWindow.prototype.setContent=function(b){var a=this.window.container.container;a.innerHTML=b;setTimeout((function(){if(a.scrollHeight>0){a.scrollTop=a.scrollHeight}else{a.scrollTop=a.offsetHeight}a=null}),100)};chatWithBuddy=function(a){hideBuddyDetail();var b="userId="+a;Light.ajax.sendRequest(Light._CHAT_WITH_BUDDY,{parameters:b,onSuccess:responseChatWithBuddy})};responseChatWithBuddy=function(b){var a=b.responseText.split(",");if(a[1]==0){var c={title:Light.getMessage("CLOSE"),ok:Light.getMessage("BUTTON_OK"),userName:a[0],popupName:"isBlockUser"};createPopupDiv("isBlockUser","isBlockUser.jst",360,c,null,null);return}if(a[1]=="n"){var c={title:Light.getMessage("CLOSE"),ok:Light.getMessage("BUTTON_OK"),userName:a[0],popupName:"noIM"};createPopupDiv("noIM","noIM.jst",360,c,null,null);return}if(a[1]=="f"){var c={title:Light.getMessage("CLOSE"),ok:Light.getMessage("BUTTON_OK"),userName:a[0],popupName:"friendOnlyIM"};createPopupDiv("friendOnlyIM","friendOnlyIM.jst",360,c,null,null);return}openChatWindow(Light.getMessage("TITLE_CHAT")+a[0],a[1])};enterChattingRoom=function(c,a){var b="chattingId="+c;Light.ajax.sendRequest(Light._ENTER_CHATTING_ROOM,{parameters:b});openChatWindow(Light.getMessage("TITLE_CHAT")+a,c)};popinChatRoom=function(c,b){var a=c.split("=");openChatWindow(b,a[1])};keyDownChat=function(b,c){var a;if(window.event){keyID=window.event.keyCode}else{keyID=b.which}if(keyID==13){sendChatMessage(c)}return !(keyID==13)};sendChatMessage=function(d){var a=document.forms["form_"+d]["chat"].value;var c=Light.getPortletById(d);var b="responseId="+d+"&tabId="+c.parent.serverId+"&portletId="+c.serverId+"&action=send&"+c.parameter+"&chat="+encodeURIComponent(a);Light.ajax.sendRequestAndUpdate(c.requestUrl,d,{evalScripts:false,parameters:b});document.forms["form_"+d]["chat"].value="";document.forms["form_"+d]["chat"].focus()};acceptChat=function(b,a){hideResponseChat();Light.ajax.sendRequest(Light._ACCEPT_CHAT,{parameters:"chattingId="+b});openChatWindow(Light.getMessage("TITLE_CHAT")+a,b)};openChatWindow=function(d,e){var b=400;var a=getScreenCenterX()-b/2-Light.portal.layout.containerLeft-Light.portal.layout.bodyLeft;var c=new PortletChatWindow(12,a,b,d,"icons chat","","chattingPortlet","/chattingPortlet"+Light._REQUEST_SUFFIX,true,false,false,false,false,true,false,5000,true,"","","","chattingId="+e);c.refresh();document.forms["form_"+c.id]["chat"].focus()};refuseChat=function(a){hideResponseChat();Light.ajax.sendRequest(Light._REFUSE_CHAT,{parameters:"chattingId="+a})};showInviteList=function(c){var b=Light.getPortletById(c);var a=b.parameter;Light.ajax.sendRequest(Light._SHOW_INVITE_LIST,{parameters:a,onSuccess:showInviteListHandler})};showInviteListHandler=function(a){var b=a.responseText;var c={title:Light.getMessage("CLOSE"),ok:Light.getMessage("BUTTON_OK"),content:b,popupName:"inviteList"};createPopupDiv("inviteList","inviteList.jst",300,c,null)};inviteBuddysToChat=function(b){var e=0;var d="";for(var a=0;a<b.elements.length;a++){if(b.elements[a].name=="chattingId"){e=parseInt(b.elements[a].value)}if(b.elements[a].type=="checkbox"&&b.elements[a].checked&&!b.elements[a].disabled){d+=b.elements[a].value+","}}if(e>0){var c="chattingId="+e+"&userIds="+d;Light.ajax.sendRequest(Light._INVITE_BUDDYS_TO_CHAT,{parameters:c})}};hideResponseChat=function(){hidePopupDiv("instantMessage")};