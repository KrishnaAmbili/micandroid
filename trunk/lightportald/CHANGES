Version 1.4.1

	This version is mainly focus on bug fix and improve performance.
	
	Highlights:
	- redesign user/role system level permission. 
	
	db:
	ALTER TABLE light_user ADD COLUMN permission BIGINT(20) DEFAULT 0 AFTER defaultStatus;
	alter table light_obj_role add column permission bigint(20) default 0 after description;

Version 1.4 final
	
	This version is mainly focus on bug fix and improve loading performance.
	
	Highlights:	
	- subscrbe without sign up feature. 
	- improve first time browser loading performance by JavaScript binding DOM instead of creating DOM or hybrid.
	- remove prototype.js framework dependency, ready for jQuery.
	
	db:
	
	CREATE TABLE light_subscriber (
	  id bigint(20) NOT NULL,
	  version int(11) NOT NULL,
	  orgId bigint(20) default NULL,
	  email varchar(255) default NULL,
	  type int(11) default NULL,
	  status int(11) default NULL,
	  createDate datetime default NULL,
	  modifiedDate datetime default NULL,
	  PRIMARY KEY  (id)
	);
	
	create unique index index_light_subscriber on light_subscriber (email,type,orgId);

Version 1.4 beta
	
	This version is mainly focus on JSON portlets and Mobile browser version.
	
	Highlights:	
	- new microblog JSON portlets
	- change major portlets (such as user profile, connection, forum etc) to JSON portlets for improving performance and flexbility to support other clients besides browser.
	- supports mobile browser version, which supports iPhone, Android, Opera Mini, IE Mobile.
	- distributed memory cache supports replication on data write and cache write based on configuration,
		default is on data write to make sure no stale objects in the cache on each cluster
		if set to replication on cache write, it will enable replication on each cache write to make cache on all clusters are identical
	- make portlet icon visibility configurable.
	- make page/portlet visibility per client configurable, such as configure one page or portlet only visible to mobile browser.	
	- introduce doHeader method to portlet to render dynamic portlet header.
	- introduce doNotification method to portlet to provide notification action, 
		such as for myMessagePortlet, show new messages count on the portlet header and page title, and refresh to display new message link;
		for ConnectionPortlet, refresh to render online icon besides connection which he/she is just logged in.		
	- minor bugs fixed.
	db:
	create index index_light_keyword_keword on light_keyword (orgId,type,keyword,weight);	
	create index index_light_user_tag_object on light_user_tag (objectId,objectType);
	
	alter table light_portlet add column showIcon int(11) default 1 after iconCssSprite;
	ALTER TABLE light_portlet CHANGE COLUMN loadFromClient client INT(11) DEFAULT 0 AFTER showIcon;
	UPDATE light_portlet SET CLIENT = 0;
	alter table light_portal_tab add column client int(11) default 0 after status;
	update light_portal_tab set client = 0;
	alter table light_organization add column adminId bigint(20) default 0 after userId;
	delete from light_portlet where tabId in (select id from light_portal_tab where ownerId='role_profile' or ownerId='role_noprofile' or ownerId='role_user');
	
	update light_group set orgId=topOrgId;
	alter table light_group drop index index_light_group_uri;
	alter table light_group drop column topOrgId;
	create index index_light_group_uri on light_group (uri,orgId);
	
	create index index_light_user_comment_object_type on light_user_comment (objectId,objectType);
	create index index_light_user_tag_org_type on light_user_tag (orgId,objectType);
	create index index_light_user_tag_object_tag on light_user_tag (objectId,objectType,tag);
	create index index_light_user_tag_org_type_tag on light_user_tag (orgId,objectType,tag);
	
	UPDATE light_portlet SET TYPE=2 WHERE NAME='ProfilePortlet';
	UPDATE light_portlet SET TYPE=2 WHERE NAME='myContactPortlet';
	UPDATE light_portlet SET TYPE=2 WHERE NAME='myBlurbPortlet';
	UPDATE light_portlet SET TYPE=2 WHERE NAME='myMessagePortlet';
	UPDATE light_portlet SET TYPE=2 WHERE NAME='friendsPortlet';
	UPDATE light_portlet SET TYPE=2 WHERE NAME='forumPortlet';
	UPDATE light_portlet SET TYPE=2 WHERE NAME='globalSearchPortlet';
	
	UPDATE light_portlet SET autorefreshed = 0, periodTime=0 WHERE NAME='myMessagePortlet' OR NAME='friendsPortlet';
	
Version 1.3
	
	This version is mainly focus on improving customization flexbility
	
	Highlights:	
	- support anonym and sign out personalize data.
	- add org Id to role table to support role customization.
	- deprecate portal-security.xml, move to portal.properties, it will improve cofiguration customization.
	- simple JavaScript funciton Light.noticePortlet to comunicate between portlets on the client side.
	- upgrade forum and forum search, offer forum topic permanent URL to render forum portlet.
	- upgrade blog and blog search, offer blog entry permanent URL to render blog portlet.
	- facebook integration.
	- improve performance and scalability by scaling out with built in distributed memory cache, file system, database.
	- minor bugs fixed.
	
	db:
	alter table light_portal drop column visitCount;
	alter table light_portal add column orgId bigint(20) default 0 after userId;
	update light_portal p set orgId = (select orgId from light_user u where p.userId = u.userId limit 1);
	update light_portal p set orgId = 0 where orgId is null;
	alter table light_portal change column userId ownerId varchar(255) after id;
	
	alter table light_portal_tab add column orgId bigint(20) default 0 after userId;
	alter table light_portal_tab add column portalId bigint(20) default 0 after userId;
	update light_portal_tab tab set portalId = (select id from light_portal portal where tab.ownerId = portal.ownerId);
	update light_portal_tab tab set orgId = (select orgId from light_portal portal where tab.ownerId = portal.ownerId);
	alter table light_portal_tab change column userId ownerId varchar(255) after portalId;
	
	alter table light_portlet add column marginTop int(11) default 10 after transparent;
	alter table light_portlet add column orgId bigint(20) default 0 after tabId;
	update light_portlet p set orgId = (select orgId from light_portal_tab t where p.tabId=t.id);
	
	alter table light_user add column currentStatus int(11) default 0 after locked;
	alter table light_user add column defaultStatus int(11) default 1 after locked;
	alter table light_flash_game add column orgId bigint(20) default 1 after postById;
	alter table light_feedback add column orgId bigint(20) default 1 after email;
	
	alter table light_portal add column version int(11) default 0 after id;
	alter table light_portal_tab add column version int(11) default 0 after id;
	alter table light_portlet add column version int(11) default 0 after id;
	alter table light_portlet_preferences add column version int(11) default 0 after id;
	alter table light_portlet_ref add column version int(11) default 0 after name;
	alter table light_organization add column version int(11) default 0 after id;
	alter table light_org_profile add column version int(11) default 0 after id;
	alter table light_permission add column version int(11) default 0 after id;
	alter table light_role_permission add column version int(11) default 0 after id;
	alter table light_obj_type add column version int(11) default 0 after id;
	alter table light_obj_role add column version int(11) default 0 after id;
	alter table light_user_obj_role add column version int(11) default 0 after id;
	alter table light_user_obj_permission add column version int(11) default 0 after id;
	alter table light_user_ext_role add column version int(11) default 0 after id;
	alter table light_subdomain add column version int(11) default 0 after orgId;
	alter table light_social_activity add column version int(11) default 0 after id;
	alter table light_pic_pos_tag add column version int(11) default 0 after id;
	alter table light_pic_pos_tag_item add column version int(11) default 0 after id;
	alter table light_user_picture_rank add column version int(11) default 0 after id;
	alter table light_user_music add column version int(11) default 0 after id;
	alter table light_user_file add column version int(11) default 0 after id;
	alter table light_user_comment add column version int(11) default 0 after id;
	alter table light_tag_filter add column version int(11) default 0 after id;
	alter table light_user_tag add column version int(11) default 0 after id;
	alter table light_user_favourite add column version int(11) default 0 after id;
	alter table light_user_block add column version int(11) default 0 after id;
	alter table light_user_invite add column version int(11) default 0 after id;
	alter table light_bulletin add column version int(11) default 0 after id;
	alter table light_message add column version int(11) default 0 after id;
	alter table light_address_book add column version int(11) default 0 after id;
	alter table light_internal_news add column version int(11) default 0 after id;
	alter table light_keyword add column version int(11) default 0 after id;
	alter table light_user_keyword add column version int(11) default 0 after id;
	alter table light_not_keyword add column version int(11) default 0 after word;
	alter table light_not_word add column version int(11) default 0 after word;
	alter table light_popular_item add column version int(11) default 0 after id;
	alter table light_viewed_item add column version int(11) default 0 after id;
	alter table light_viewed_item_user add column version int(11) default 0 after id;	
	alter table light_recommended_item add column version int(11) default 0 after id;
	alter table light_flash_game add column version int(11) default 0 after id;
	alter table light_bookmark add column version int(11) default 0 after id;
	alter table light_feedback add column version int(11) default 0 after id;
	alter table light_todo add column version int(11) default 0 after id;
	alter table light_horoscope add column version int(11) default 0 after id;
	alter table light_horoscope_weekly add column version int(11) default 0 after id;
	alter table light_note add column version int(11) default 0 after id;
	alter table light_widget add column version int(11) default 0 after id;
	alter table light_calendar add column version int(11) default 0 after id;
	alter table light_calendar_event add column version int(11) default 0 after id;
	alter table light_calendar_holiday add column version int(11) default 0 after id;
	alter table light_chatting add column version int(11) default 0 after id;
	alter table light_chatting_user add column version int(11) default 0 after id;
	alter table light_chatting_record add column version int(11) default 0 after id;
	alter table light_connection add column version int(11) default 0 after id;
	alter table light_forum_category add column version int(11) default 0 after id;
	alter table light_forum add column version int(11) default 0 after id;
	alter table light_group_category add column version int(11) default 0 after id;
	alter table light_blog add column version int(11) default 0 after id;
	alter table light_blog_category add column version int(11) default 0 after id;
	alter table light_category_ad add column version int(11) default 0 after id;
	
	alter table light_portlet_preferences add column orgId bigint(20) default 0 after version;
	alter table light_permission add column orgId bigint(20) default 0 after version;
	alter table light_role_permission add column orgId bigint(20) default 0 after version;
	alter table light_obj_type add column orgId bigint(20) default 0 after version;
	alter table light_user_ext_role add column orgId bigint(20) default 0 after version;	
	alter table light_user_profile add column orgId bigint(20) default 0 after version;
	alter table light_user_picture_rank add column orgId bigint(20) default 0 after version;
	alter table light_user_music add column orgId bigint(20) default 0 after version;
	alter table light_user_file add column orgId bigint(20) default 0 after version;
	alter table light_user_comment add column orgId bigint(20) default 0 after version;
	alter table light_user_favourite add column orgId bigint(20) default 0 after version;	
	alter table light_user_block add column orgId bigint(20) default 0 after version;
	alter table light_user_invite add column orgId bigint(20) default 0 after version;	
	alter table light_message add column orgId bigint(20) default 0 after version;
	alter table light_address_book add column orgId bigint(20) default 0 after version;
	alter table light_viewed_item add column orgId bigint(20) default 0 after version;
	alter table light_viewed_item_user add column orgId bigint(20) default 0 after version;	
	alter table light_recommended_item add column orgId bigint(20) default 0 after version;
	alter table light_bookmark add column orgId bigint(20) default 0 after version;
	alter table light_todo add column orgId bigint(20) default 0 after version;
	alter table light_horoscope add column orgId bigint(20) default 0 after version;
	alter table light_horoscope_weekly add column orgId bigint(20) default 0 after version;
	alter table light_note add column orgId bigint(20) default 0 after version;
	alter table light_not_keyword add column orgId bigint(20) not null default 0 after word;
	alter table light_not_word add column orgId bigint(20) not null default 0 after word;
	alter table light_calendar add column orgId bigint(20) default 0 after version;
	alter table light_calendar_holiday add column orgId bigint(20) default 0 after version;
	alter table light_chatting_user add column orgId bigint(20) default 0 after version;
	alter table light_chatting_record add column orgId bigint(20) default 0 after version;
	alter table light_group add column orgId bigint(20) default 0 after version;
	alter table light_user_group add column orgId bigint(20) default 0 after version;
	alter table light_category_ad add column orgId bigint(20) default 0 after version;
	alter table light_connection add column orgId bigint(20) default 0 after version;
	
	alter table light_portal add column createDate datetime;
	alter table light_portal_tab add column createDate datetime;
	alter table light_portlet add column createDate datetime;
	alter table light_portlet_preferences add column createDate datetime;
	alter table light_portlet_ref add column createDate datetime;
	alter table light_organization add column createDate datetime;
	alter table light_org_profile add column createDate datetime;
	alter table light_permission add column createDate datetime;
	alter table light_role_permission add column createDate datetime;
	alter table light_obj_type add column createDate datetime;
	alter table light_obj_role add column createDate datetime;
	alter table light_user_profile add column createDate datetime;
	alter table light_user_obj_role add column createDate datetime;
	alter table light_user_obj_permission add column createDate datetime;
	alter table light_user_ext_role add column createDate datetime;
	alter table light_subdomain add column createDate datetime;
	alter table light_social_activity add column createDate datetime;
	alter table light_pic_pos_tag add column createDate datetime;
	alter table light_pic_pos_tag_item add column createDate datetime;
	alter table light_user_picture_rank add column createDate datetime;
	alter table light_user_picture add column createDate datetime;
	alter table light_user_music add column createDate datetime;
	alter table light_user_file add column createDate datetime;
	alter table light_user_comment add column createDate datetime;
	alter table light_tag_filter add column createDate datetime;
	alter table light_user_tag add column createDate datetime;
	alter table light_user_favourite add column createDate datetime;
	alter table light_user_block add column createDate datetime;
	alter table light_user_invite add column createDate datetime;
	alter table light_bulletin add column createDate datetime;
	alter table light_message add column createDate datetime;
	alter table light_address_book add column createDate datetime;
	alter table light_internal_news add column createDate datetime;
	alter table light_keyword add column createDate datetime;
	alter table light_user_keyword add column createDate datetime;
	alter table light_not_keyword add column createDate datetime;
	alter table light_not_word add column createDate datetime;
	alter table light_popular_item add column createDate datetime;
	alter table light_viewed_item add column createDate datetime;
	alter table light_viewed_item_user add column createDate datetime;	
	alter table light_recommended_item add column createDate datetime;
	alter table light_flash_game add column createDate datetime;
	alter table light_bookmark add column createDate datetime;
	alter table light_feedback add column createDate datetime;
	alter table light_todo add column createDate datetime;
	alter table light_horoscope add column createDate datetime;
	alter table light_horoscope_weekly add column createDate datetime;
	alter table light_note add column createDate datetime;
	alter table light_widget add column createDate datetime;
	alter table light_calendar add column createDate datetime;
	alter table light_calendar_event add column createDate datetime;
	alter table light_calendar_holiday add column createDate datetime;
	alter table light_chatting add column createDate datetime;
	alter table light_chatting_user add column createDate datetime;
	alter table light_chatting_record add column createDate datetime;
	alter table light_connection add column createDate datetime;
	alter table light_forum_post add column createDate datetime;
	alter table light_forum_category add column createDate datetime;
	alter table light_forum add column createDate datetime;
	alter table light_group add column createDate datetime;
	alter table light_group_category add column createDate datetime;
	alter table light_user_group add column createDate datetime;
	alter table light_blog add column createDate datetime;
	alter table light_blog_category add column createDate datetime;
	alter table light_category_ad add column createDate datetime;
	
	alter table light_user add column modifiedDate datetime;	
	alter table light_portal add column modifiedDate datetime;	
	alter table light_portal_tab add column modifiedDate datetime;
	alter table light_portlet add column modifiedDate datetime;
	alter table light_portlet_preferences add column modifiedDate datetime;
	alter table light_portlet_ref add column modifiedDate datetime;
	alter table light_organization add column modifiedDate datetime;
	alter table light_org_profile add column modifiedDate datetime;
	alter table light_pic_pos_tag add column modifiedDate datetime;
	alter table light_user_profile add column modifiedDate datetime;
	alter table light_pic_pos_tag_item add column modifiedDate datetime;
	alter table light_user_picture_rank add column modifiedDate datetime;
	alter table light_user_picture add column modifiedDate datetime;
	alter table light_user_music add column modifiedDate datetime;
	alter table light_user_file add column modifiedDate datetime;	
	alter table light_tag_filter add column modifiedDate datetime;	
	alter table light_bulletin add column modifiedDate datetime;
	alter table light_address_book add column modifiedDate datetime;
	alter table light_internal_news add column modifiedDate datetime;
	alter table light_keyword add column modifiedDate datetime;
	alter table light_user_keyword add column modifiedDate datetime;
	alter table light_popular_item add column modifiedDate datetime;
	alter table light_viewed_item add column modifiedDate datetime;
	alter table light_viewed_item_user add column modifiedDate datetime;	
	alter table light_flash_game add column modifiedDate datetime;
	alter table light_bookmark add column modifiedDate datetime;
	alter table light_todo add column modifiedDate datetime;
	alter table light_note add column modifiedDate datetime;
	alter table light_calendar add column modifiedDate datetime;
	alter table light_calendar_event add column modifiedDate datetime;
	alter table light_forum_post add column modifiedDate datetime;
	alter table light_group add column modifiedDate datetime;
	alter table light_user_group add column modifiedDate datetime;
	
	create unique index index_light_not_word on light_not_word (word);
	create unique index index_light_not_keyword on light_not_keyword (word);
	create unique index index_light_portlet_ref on light_portlet_ref (name);
	
	alter table light_portlet_ref add column id bigint(20) default 0 not null first;
	SET @rownum=0;
	UPDATE light_portlet_ref t, (SELECT @rownum:=@rownum+1 rownum, light_portlet_ref.* FROM light_portlet_ref) r
	SET t.id = r.rownum
	WHERE (t.name = r.name);
	alter table light_portlet_ref drop primary key;
	alter table light_portlet_ref add primary key(id);
	
	alter table light_subdomain add column id bigint(20) default 0 not null first;
	SET @rownum=0;
	UPDATE light_subdomain t, (SELECT @rownum:=@rownum+1 rownum, light_subdomain.* FROM light_subdomain) r
	SET t.id = r.rownum
	WHERE (t.orgId = r.orgId and t.uri = r.uri);
	alter table light_subdomain drop primary key;
	alter table light_subdomain add primary key(id);
		
	alter table light_not_word add column id bigint(20) default 0 not null first;
	SET @rownum=0;
	UPDATE light_not_word t, (SELECT @rownum:=@rownum+1 rownum, light_not_word.* FROM light_not_word) r
	SET t.id = r.rownum
	WHERE (t.orgId = r.orgId and t.word = r.word);
	alter table light_not_word drop primary key;
	alter table light_not_word add primary key(id);
	
	alter table light_not_keyword add column id bigint(20) default 0 not null first;
	SET @rownum=0;
	UPDATE light_not_keyword t, (SELECT @rownum:=@rownum+1 rownum, light_not_keyword.* FROM light_not_keyword) r
	SET t.id = r.rownum
	WHERE (t.orgId = r.orgId and t.word = r.word);
	alter table light_not_keyword drop primary key;
	alter table light_not_keyword add primary key(id);
	
	CREATE TABLE light_sequence_id (
	  id bigint(20) NOT NULL,
	  version int(11) NOT NULL,
	  orgId bigint(20) default NULL,
	  currentId bigint(20) default NULL,
	  createDate datetime default NULL,
	  modifiedDate datetime default NULL,
	  PRIMARY KEY  (id)
	);
	
	CREATE TABLE light_replication_message (
	  id bigint(20) NOT NULL auto_increment,
	  orgId bigint(20) default 0,
	  server varchar(255) default NULL,
	  event varchar(255) default NULL,
	  className varchar(255)default NULL,
	  classId bigint(20) default 0,
	  message blob,
	  createDate datetime,
	  PRIMARY KEY  (id)
	);
	
	drop table light_chat;
	drop table light_chat_status_ref;
	drop table light_channel_ref;
	
	alter table light_user_keyword add column orgId bigint(20) default 1 after status;
	
	alter table light_user_comment add column parentId bigint(20) default 0 after status;
	
	alter table light_user_keyword add column type int after weight;
	update light_user_keyword set type=0;
	
	alter table light_org_profile change column title meta varchar(1024) after language;
	alter table light_organization drop column meta;
	
	alter table light_user_keyword change column userId personId bigint(20) after id;
	alter table light_viewed_item_user change column postById personId bigint(20) after id;
	alter table light_recommended_item change column userId personId bigint(20) after id;
	delete from light_recommended_item;
	
	alter table light_user add column personId bigint(20) after id;
	update light_user set personId = 0;
	
	alter table light_portal drop column showLocaleBar;
	alter table light_portal drop column defaultSearchEngine;
	
	drop table light_obj_role;//recreate it using app
	update light_user_obj_role set roleId=1 where orgId = 1 and roleId=15;//default
	update light_user_obj_role set roleId=2 where orgId = 1 and roleId=16;//user
	update light_user_obj_role set roleId=4 where orgId = 1 and roleId=17;//member
	update light_user_obj_role set roleId=3 where orgId = 1 and roleId=19;//owner
	update light_user_obj_role set roleId=6 where orgId = 1 and roleId=18;//admin
	update light_user_obj_role set roleId=5 where orgId = 1 and roleId=20;//group
		
	alter table light_organization add column title varchar(255) after webId;
	alter table light_organization add column meta varchar(255) after title;
	
	update light_portlet set windowSkin = 'WindowSkin2' where windowSkin='PortletWindow' or windowSkin like 'WindowAppearance%';
	update light_portlet set windowSkin = 'WindowSkin1' where windowSkin='PortletWindow1';
	update light_portlet set windowSkin = 'WindowSkin2' where windowSkin='PortletWindow2';
	update light_portlet set windowSkin = 'WindowSkin3' where windowSkin='PortletWindow3';
	update light_portlet set windowSkin = 'WindowSkin4' where windowSkin='PortletWindow4';
	update light_portlet set windowSkin = 'WindowSkin5' where windowSkin='PortletWindow5';
	
	update light_portlet_ref set windowSkin = 'WindowSkin2' where windowSkin='PortletWindow' or windowSkin like 'WindowAppearance%';
	update light_portlet_ref set windowSkin = 'WindowSkin1' where windowSkin='PortletWindow1';
	update light_portlet_ref set windowSkin = 'WindowSkin2' where windowSkin='PortletWindow2';
	update light_portlet_ref set windowSkin = 'WindowSkin3' where windowSkin='PortletWindow3';
	update light_portlet_ref set windowSkin = 'WindowSkin4' where windowSkin='PortletWindow4';
	update light_portlet_ref set windowSkin = 'WindowSkin5' where windowSkin='PortletWindow5';
	
	alter table light_portal_tab change column portletWindowType windowSkin varchar(255);
	update light_portal_tab set windowSkin = 'WindowSkin2' where windowSkin='PortletWindow' or windowSkin like 'WindowAppearance%';
	update light_portal_tab set windowSkin = 'WindowSkin1' where windowSkin='PortletWindow1';
	update light_portal_tab set windowSkin = 'WindowSkin2' where windowSkin='PortletWindow2';
	update light_portal_tab set windowSkin = 'WindowSkin3' where windowSkin='PortletWindow3';
	update light_portal_tab set windowSkin = 'WindowSkin4' where windowSkin='PortletWindow4';
	update light_portal_tab set windowSkin = 'WindowSkin5' where windowSkin='PortletWindow5';
	
	alter table light_portlet_preferences change column value value text;

Version 1.2.2

	This version is mainly a bug fix version for Light Portal version 1.2.
	
	Highlights
	- upgrade OpenId4java library to newest version
	- refactoring JavaScript library
	- configure IE specific common.css
	
	db:
	alter table light_recommended_item change column link link varchar(1024) after id;
	
Version 1.2.1

	This version is mainly a bug fix version for Light Portal version 1.2.
	
	New features:
	- improve browser bookmarking and back/forward buttons functions
	- enhance privacy setting for page/picture/music/file
	
	bugs:
	- fixed logout failed issue.
	- other minor bugs fixed.
	
	db:
	update light_portal_tab set status = 4 where status = 3;
	update light_portal_tab set status = 3 where status = 2;
	
Version 1.2

	This version is mainly focus on separating Portal UI App from Portal Server using JSON communication.
	Light Portal version 1.2 only supports HTML/JavaScript/AJAX Portal UI APP, but this version make Light Portal possible to support other type clients, such as
	other RIAs like Flex, Silverlight etc, Mobile Apps like iPhone app, Android app,blackberry app etc with uniform portal server services API.	
	
	New features:
	
	- separating Portal UI App from Portal Server using JSON communication
	- upgrade system portlets to JSON portlets
	- upgrade portal-security.xml schema to support role based dynamic permissions configuration
	- upgrade portal-layout.xml schema to support sub tab configuration
	- support browser bookmarking and back/forward buttons using reallysimplehistory JavaScript library
	
	db:
	update light_portal_tab set status = 4 where status = 1;
	update light_portal_tab set status = 1 where status = 2;
	update light_portal_tab set status = 2 where status = 4;
	
	alter table light_message change column status status integer after content;
	alter table light_message add column direction integer default 0 after content ;
	alter table light_message add column contentFormat integer default 0 after content ;
	
	alter table light_user change column createDate createDate datetime after visitCount;
	alter table light_portal change column createDate createDate datetime after visitCount;
	alter table light_user_picture_rank change column createDate createDate datetime;
	alter table light_user_block change column createDate createDate datetime;
	alter table light_user_invite change column createDate createDate datetime;
	alter table light_group change column createDate createDate datetime after viewCount;
	drop table light_friend_request;
	alter table light_user_favourite change column createDate createDate datetime after favouriteId;
	alter table light_feedback change column createDate createDate datetime after visitCount;
	
	delete from light_portlet_ref where name = 'userPortlet';
	select name,path from light_portlet where name = 'userPortlet';
	update light_portlet set name='loginPortlet', path='/loginPortlet.lp' where name = 'userPortlet';
	update light_portlet set icon='/light/images/feed.png' where icon ='/light/images/usat.png';
	update light_portlet_ref set icon='/light/images/feed.png' where icon ='/light/images/usat.png';
	
Version 1.1
	New features:
	
	- support Flex/JSON type portlet (see details at MyMusicPlayerPortlet) and ViewTemplate/JSON type portlet (see details at MyCardPortlet)
	- improve performance using CSS Sprites
	- My Tags feature allows users tag themselves which is indexed and searchable and tag cloud feature.
	- upgrade chatting function to allow members to invite friends to join current chatting for group chatting purpose.
	- new Chat Room portlet to allow members to create/join chat rooms.
	- chatting window can be pop out to a new browser window, and pop in back.
	- new feature to show sub tabs as parent tab's drop down menu.
	- refactoring JavaScript and Java communication using JSON.
	- new embed widget container portlet.
	- refactoring portal header render logic, take it out from JavaScript to view (JSP).
	- integrate group with organization, group is a sub organizatoin.
	- merge group bulletion portlet to bulletion portlet, remove group bulletin portlet.
	- merge group forum portlet to forum portlet, remove group forum portlet.
	- Blog support categories, and blog view can be configured to only show individual category or all categories.
	- add Avatar/Avatar URL UI custom tags to rendering user/group's link and picture for improving reusability and maintainability.
	- support multiple formats for internal user/group public URL, such as subdomain based (sports.lightportal.org), suffix based (lightportal.org/group/sports).

	Bugs:
	- lots of bugs fixed.
	
	db:	
	create unique index index_light_chat on light_chat (userId);
	
	CREATE TABLE light_user_tag (
	  id bigint(20) NOT NULL,
	  userId bigint(20) default NULL,
  	  objectId bigint(20) default NULL,
  	  objectType int(11) default NULL,
	  tag varchar(255)  NULL,
	  orgId bigint(20) default NULL,
	  PRIMARY KEY  (id)
	);
	create index light_user_tag_tag on light_user_tag (tag);
	select DISTINCT  icon from light_portlet where icon like '/light/images/%' order by icon;
	
	alter table light_portlet add column iconCssSprite varchar(255) default null after icon;
	alter table light_portlet_ref add column iconCssSprite varchar(255) default null after icon;
		
	update light_portlet set iconCssSprite='icons addressbook' where icon='/light/images/addressbook.gif';
	update light_portlet set iconCssSprite='icons advertise' where icon='/light/images/advertise.gif';
	update light_portlet set iconCssSprite='icons blog' where icon='/light/images/blog.gif';
	update light_portlet set iconCssSprite='icons blog' where icon='/light/images/blogmarks.gif';
	update light_portlet set iconCssSprite='icons blurb' where icon='/light/images/blurb.gif';
	update light_portlet set iconCssSprite='icons bookmark' where icon='/light/images/bookmark.gif';
	update light_portlet set iconCssSprite='icons bulletin' where icon='/light/images/bulletin.gif';
	update light_portlet set iconCssSprite='icons business' where icon='/light/images/business.gif';
	update light_portlet set iconCssSprite='icons chat' where icon='/light/images/chat.gif';
	update light_portlet set iconCssSprite='icons comments' where icon='/light/images/comments.gif';
	update light_portlet set iconCssSprite='icons calendar' where icon='/light/images/calendar.gif';
	update light_portlet set iconCssSprite='icons dictionary' where icon='/light/images/dictionary.gif';
	update light_portlet set iconCssSprite='icons document' where icon='/light/images/document.gif';
	update light_portlet set iconCssSprite='icons feed' where icon='/light/images/feed.png' or icon='/light/images/abc.ico';
	update light_portlet set iconCssSprite='icons file' where icon='/light/images/file.gif';
	update light_portlet set iconCssSprite='icons flickr' where icon='/light/images/flickr.gif';
	update light_portlet set iconCssSprite='icons forum' where icon='/light/images/forum.gif';
	update light_portlet set iconCssSprite='icons friend' where icon='/light/images/friend.gif';
	update light_portlet set iconCssSprite='icons friends' where icon='/light/images/friends.gif';
	update light_portlet set iconCssSprite='icons google' where icon='/light/images/google.gif';
	update light_portlet set iconCssSprite='icons group' where icon='/light/images/group.gif';
	update light_portlet set iconCssSprite='icons gmail' where icon='/light/images/gmail.gif';
	update light_portlet set iconCssSprite='icons horoscope' where icon='/light/images/horoscope.gif';
	update light_portlet set iconCssSprite='icons info' where icon='/light/images/info.png';
	update light_portlet set iconCssSprite='icons interests' where icon='/light/images/interests.gif';
	update light_portlet set iconCssSprite='icons internal' where icon='/light/images/internal.gif';
	update light_portlet set iconCssSprite='icons logoSmall' where icon='/light/images/logoSmall.gif';
	update light_portlet set iconCssSprite='icons message' where icon='/light/images/message.gif' or icon='/light/images/popmail.gif';
	update light_portlet set iconCssSprite='icons music' where icon='/light/images/music.png';
	update light_portlet set iconCssSprite='icons note' where icon='/light/images/note.gif';
	update light_portlet set iconCssSprite='icons online' where icon='/light/images/online.gif';
	update light_portlet set iconCssSprite='icons org' where icon='/light/images/org.gif';
	update light_portlet set iconCssSprite='icons people' where icon='/light/images/people.gif';
	update light_portlet set iconCssSprite='icons picture' where icon='/light/images/picture.gif';
	update light_portlet set iconCssSprite='icons popular' where icon='/light/images/popular.gif' or icon='/light/images/flash.png';
	update light_portlet set iconCssSprite='icons recommended' where icon='/light/images/recommended.gif';
	update light_portlet set iconCssSprite='icons search' where icon='/light/images/search.gif';
	update light_portlet set iconCssSprite='icons slang' where icon='/light/images/slang.gif';
	update light_portlet set iconCssSprite='icons store' where icon='/light/images/store.png';
	update light_portlet set iconCssSprite='icons todolist' where icon='/light/images/todolist.gif';
	update light_portlet set iconCssSprite='icons user' where icon='/light/images/user.gif';
	update light_portlet set iconCssSprite='icons video' where icon='/light/images/video.png';
	update light_portlet set iconCssSprite='icons viewed' where icon='/light/images/viewed.gif';
	update light_portlet set iconCssSprite='icons weather' where icon='/light/images/weather.gif';
	
	update light_portlet set icon='/light/images/messenger.png' where icon='/light/images/forum.gif' or icon='/light/images/blurb.gif';
	update light_portlet set icon='/light/images/advertise.png' where icon='/light/images/advertise.gif';
	update light_portlet set icon='/light/images/blog.png' where icon='/light/images/blog.gif';
	update light_portlet set icon='/light/images/comment.png' where icon='/light/images/comment.gif';
	update light_portlet set icon='/light/images/block.png' where icon='/light/images/block.gif';
	update light_portlet set icon='/light/images/horoscope.png' where icon='/light/images/horoscope.gif';
	update light_portlet set icon='/light/images/slang.png' where icon='/light/images/slang.gif';
	
	alter table light_user add column uriType int(11) default 0 after chosedUri;
	update light_user set uriType=1 where chosedUri is not null;
	update light_user set chosedUri = assignedUri where chosedUri is null;
	alter table light_user change column chosedUri userUri varchar(255) after assignedUri;
	alter table light_user drop column assignedUri;
	
	CREATE TABLE light_subdomain (
	  uri varchar(255) NOT NULL,
	  orgId bigint(20) NOT NULL,
	  PRIMARY KEY  (uri,orgId)
	);
	insert into light_subdomain select userUri as uri,orgId as orgId from light_user;
	insert into light_subdomain select webId as uri,parentId as orgId from light_organization where parentId > 0;

	drop table if exists light_chatting;
	drop table if exists light_chatting_record;
	/*Table structure for table light_chatting */
	CREATE TABLE light_chatting (
	  id bigint(20) NOT NULL,
	  chatName varchar(255)  NULL,
	  chatDesc varchar(255)  NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,
	  chatType int(11) default NULL,
	  status int(11) default NULL,
	  createDate date NULL,
	  PRIMARY KEY  (id)
	);
	/*Table structure for table light_chatting_record */
	CREATE TABLE light_chatting_record (
	  id bigint(20) NOT NULL,
	  chattingId bigint(20) default NULL,
	  userId bigint(20) default NULL,
	  displayName varchar(255)  NULL,
	  content longtext collate utf8_unicode_ci,
	  PRIMARY KEY  (id),
	  KEY FK21639341FE20D94A (chattingId),
	  CONSTRAINT FK21639341FE20D94A FOREIGN KEY (chattingId) REFERENCES light_chatting (id)
	) ;	
	/*Table structure for table light_chatting_user */	
	CREATE TABLE light_chatting_user (
	  id bigint(20) NOT NULL,
	  chattingId bigint(20) default NULL,
	  userId bigint(20) default NULL,
	  status int(11) default NULL,
	  PRIMARY KEY  (id),
	  KEY FKB7510EBBFE20D94A (chattingId),
	  CONSTRAINT FKB7510EBBFE20D94A FOREIGN KEY (chattingId) REFERENCES light_chatting (id)
	);
	
	update light_user_obj_role set objectTypeId=10 where objectTypeId=1;
	CREATE TABLE light_obj_type (
	  id bigint(20) NOT NULL,
	  name varchar(255) default NULL,
	  PRIMARY KEY  (id)
	);
	CREATE TABLE light_blog_category (
	  id bigint(20) NOT NULL,
	  name varchar(255) default NULL,
	  ctgrDesc varchar(255) default NULL,
	  parentId bigint(20) default NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,  
	  status int(11) default NULL,
	  createDate datetime default NULL,
	  PRIMARY KEY  (id)
	);
	alter table light_blog add column categoryId bigint(20) default 0 after orgId;
	update light_user set newsLetter = 1, notification = 1;
	alter table light_portlet add column colspan int(11) default 0 after rowNumber;
	alter table light_organization add column email varchar(255) after mx;
	alter table light_organization add column receiveEmail varchar(255) after email;
	alter table light_user_invite add column content varchar(255) after inviteEmail;
	
	create unique index index_light_user_uri on light_user (chosedUri,orgId);
	create unique index index_light_group_uri on light_group (uri,topOrgId);
	create unique index index_light_org on light_organization (webId,parentId);
	create unique index index_light_store_uri on light_store (uri,topOrgId);
	
	alter table light_portlet_ref add column keywords varchar(255) after name;
	
	alter table light_pic_pos_tag add column objectId bigint(20) default 0 after type;
	
	alter table light_calendar_event add column orgId bigint(20) default 0 after userId;
		
	alter table light_feedback add column userId bigint(20) default 1 after id;
	alter table light_feedback change column count visitCount int(11) default 0;
	insert into light_user_comment
	select @rownum:=@rownum+1 as id, light_blog_comment.postById as userId, light_blog_comment.blogId as objectTypeId, 2 as objectType, light_blog_comment.content as content, 1 as status, light_blog_comment.createDate as createDate
	from (select @rownum:=16) r, light_blog_comment;
	
	drop table light_blog_comment;
	drop table light_category_ad_comment;
	drop table  light_popular_item_comment;
	
	alter table light_pic_pos_tag_item add column pictureId bigint(20) default 0 after tagId;
	
	/* upgrade light_user_picture to support score which members can vote it*/
	alter table light_user_picture add column score int(11) default 0 after rankable;
		
	/* upgrade light_user_comment to generic comment */
	alter table light_user_comment change column postById objectId bigint(20);
	alter table light_user_comment add column objectType int(11) default 0 after objectId;

	/* merge light_group_picture to light_user_picture */	
	alter table light_user_picture add column orgId bigint(20) default 0 after userId;
	alter table light_user_picture add column topOrgId bigint(20) default 0 after orgId;
	update light_user_picture p set p.orgId= (select orgId from light_user u where u.id = p.userId);
	update light_user_picture p set p.topOrgId= (select orgId from light_user u where u.id = p.userId);
	insert into light_user_picture 
	select @rownum:=@rownum+1 as id, 0 as userId, p.groupId as orgId, 0 as topOrgId, p.pictureUrl as pictureUrl, p.pictureWidth as pictureWidth, p.pictureHeight as pictureHeight, p.caption as caption, null as tag, 2 as status, 0 as rankable, p.createDate as createDate 
	from (select @rownum:=11) r, light_group_picture p;
    
    /* light_pic_pos_tag */
    CREATE TABLE light_pic_pos_tag (
	  id bigint(20) NOT NULL,
	  pictureId bigint(20) default NULL,
	  pictureUrl varchar(255) default NULL,	  
	  parentId bigint(20) default NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,
	  topOrgId bigint(20) default NULL,
	  positionX int(11) default NULL,
	  positionY int(11) default NULL,
	  tag varchar(255) default NULL,
	  type int(11) default NULL,
	  createDate datetime default NULL,
	  PRIMARY KEY  (id)
	);
    
    CREATE TABLE light_pic_pos_tag_item (
	  id bigint(20) NOT NULL,
	  tagId bigint(20) default NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,
	  topOrgId bigint(20) default NULL,
	  name varchar(255) default NULL,
	  description text,
	  itemOwner varchar(255) default NULL,
	  createDate datetime default NULL,
	  PRIMARY KEY  (id)
	);
	
	/* integrate group to organization */	
	delete from light_organization where id in (select id from light_group);
	delete from light_org_profile where orgId in (select id from light_group);
	delete from light_group;
	delete from light_group_bulletin;
	delete from light_group_forum;
	delete from light_group_picture;
	delete from light_user_group;
	delete from light_portal where userId like 'group_%';
	delete from light_portlet where tabId in (select id from light_portal_tab where userId like 'group_%');
	delete from light_portal_tab where userId like 'group_%';
	select * from light_portlet where tabId in (select id from light_portal_tab where userId like 'group_%');
	
	alter table light_group add column parentId bigint(20) default 0;
	alter table light_group add column topOrgId bigint(20) default 0;
	alter table light_group drop column orgId;
	
	/* merge group bulletin to bulletion */
	alter table light_bulletin add column orgId bigint(20) default 0;
	alter table light_bulletin add column type integer default 1;
	delete from light_portlet where name = 'groupBulletinPortlet';
	delete from light_portlet_ref where name = 'groupBulletinPortlet';
	drop table light_group_bulletin;
	
	/* merge group forum to forum */
	delete from light_portlet where name = 'groupForumPortlet';
	delete from light_portlet_ref where name = 'groupForumPortlet';
	drop table light_group_forum;
	
	/* schema change for complianting Oracle */
	alter table light_category_ad_comment change column comment content text;
	alter table light_popular_item_comment change column comments content text;
	alter table light_user_comment change column comments content text;
	alter table light_blog_comment change column comment content text;
	alter table light_org_profile change column view content text;
	alter table light_org_profile change column maxView maxContent text;
	alter table light_portlet change column mode portletMode integer;
	alter table light_portlet_ref change column mode portletMode integer;
	alter table clfile change column size fileSize bigint(20);
	
	/* add versioning */
	alter table light_forum_post add column version integer default 0;
	alter table light_user_picture add column version integer default 0;
	alter table light_group add column version integer default 0;
	alter table light_user_group add column version integer default 0;
	alter table light_user add column version integer default 0;
	alter table light_user_profile add column version integer default 0;

	/*Table structure for table light_social_activity */
	CREATE TABLE light_social_activity (
	  id bigint(20) NOT NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,
	  content varchar(255) default NULL,
	  type int(11) default NULL,
	  status int(11) default NULL,
	  createDate datetime default NULL,
	  PRIMARY KEY  (id)
	);
	/* integrate new permission model */
	drop table light_role;
	drop table light_user_role;
		
	CREATE TABLE light_obj_role (
	  id bigint(20) NOT NULL,
	  name varchar(255) default NULL,
	  description varchar(255) default NULL,
	  PRIMARY KEY  (id)
	);
	CREATE TABLE light_permission (
	  id bigint(20) NOT NULL,
	  name varchar(255) default NULL,
	  description varchar(255) default NULL,
	  PRIMARY KEY  (id)
	);
	
	CREATE TABLE light_role_permission (
	  id bigint(20) NOT NULL,
	  roleId   gint(20) default NULL,
	  permissionId bigint(20) default NULL,
	  PRIMARY KEY  (id)
	);
	
	CREATE TABLE light_user_obj_permission (
	  id bigint(20) NOT NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,
	  objectId bigint(20) default NULL,
	  objectTypeId bigint(20) default NULL,
	  permissionId bigint(20) default NULL,
	  PRIMARY KEY  (id)
	);
	
	CREATE TABLE light_user_obj_role (
	  id bigint(20) NOT NULL,
	  userId bigint(20) default NULL,
	  orgId bigint(20) default NULL,
	  objectId bigint(20) default NULL,
	  objectTypeId bigint(20) default NULL,
	  roleId bigint(20) default NULL,
	  PRIMARY KEY  (id)
	);
	
	/*Data for the table `light_permission` */

	insert  into `light_permission`(`id`,`name`,`description`) values (1,'add','Add');
	insert  into `light_permission`(`id`,`name`,`description`) values (2,'update','Update');
	insert  into `light_permission`(`id`,`name`,`description`) values (3,'delete','Delete');
	insert  into `light_permission`(`id`,`name`,`description`) values (4,'view','View');
	insert  into `light_permission`(`id`,`name`,`description`) values (101,'allowLookAndFeel','Look and Feel');
	insert  into `light_permission`(`id`,`name`,`description`) values (102,'allowLayout','Layout');
	insert  into `light_permission`(`id`,`name`,`description`) values (103,'allowAddTab','Add Tab');
	insert  into `light_permission`(`id`,`name`,`description`) values (104,'allowAddContent','Add Content');
	insert  into `light_permission`(`id`,`name`,`description`) values (105,'allowSignIn','Sign In');
	insert  into `light_permission`(`id`,`name`,`description`) values (106,'allowTurnOff','Turn Off');

	/*Data for the table `light_obj_role` */
	
	insert  into `light_obj_role`(`id`,`name`,`description`) values (1,'channel_news','tab.title.news');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (2,'channel_finance','tab.title.finance');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (3,'channel_tech','tab.title.tech');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (4,'channel_business','tab.title.business');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (5,'channel_politics','tab.title.politics');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (6,'channel_health','tab.title.health');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (7,'channel_entertainment','tab.title.entertainment');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (8,'channel_sports','tab.title.sports');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (9,'channel_culture','tab.title.culture');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (10,'channel_search','tab.title.search');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (11,'channel_recipe','tab.title.recipe');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (12,'channel_ad','tab.title.ad');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (13,'channel_forum','tab.title.forum');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (14,'channel_game','tab.title.game');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (15,'role_guest','Unauthenticated users always have this role');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (16,'role_user','Authenticated users should be assigned this role');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (17,'role_member','All users who belong to a organization have this role within that organization');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (18,'role_admin','Administrators are super users who can do anything');
	insert  into `light_obj_role`(`id`,`name`,`description`) values (19,'role_owner','This is an implied role with respect to the objects users create');
	
	/*Data for the table `light_role_permission` */
	
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (1,15,105);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (2,16,105);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (3,17,101);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (4,17,102);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (5,17,103);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (6,17,104);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (7,17,105);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (8,18,101);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (9,18,102);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (10,18,103);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (11,18,104);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (12,18,105);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (13,19,101);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (14,19,102);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (15,19,103);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (16,19,104);
	insert  into `light_role_permission`(`id`,`roleId`,`permissionId`) values (17,19,105);
	
	/* insert data to `light_user_obj_role` or use store procedure*/
	insert into light_user_obj_role
	select @rownum:=@rownum+1 as id, light_user.id as userId, light_user.orgId as orgId, light_user.orgId as objectId, 1 as objectTypeId, 15 as roleId
	from (select @rownum:=0) r, light_user where userId like 'default@%';
	/* user id 2 5 8 are admin users */
	insert into light_user_obj_role
	select @rownum:=@rownum+1 as id, light_user.id as userId, light_user.orgId as orgId, light_user.orgId as objectId, 1 as objectTypeId, 18 as roleId
	from (select @rownum:=3) r, light_user where id = 2 or id = 5 or id = 8;
	/* user id 1 4 7 are default users */
	insert into light_user_obj_role
	select @rownum:=@rownum+1 as id, light_user.id as userId, light_user.orgId as orgId, light_user.orgId as objectId, 1 as objectTypeId, 17 as roleId
	from (select @rownum:=6) r, light_user where id != 1 and id != 4 and id != 7;

	/*stored procedures to insert data to `light_user_obj_role` */
	
	DELIMITER $$
	DROP PROCEDURE IF EXISTS `portal`.`addUserRole`$$
	CREATE DEFINER=`jack`@`localhost` PROCEDURE `addUserRole`()
	BEGIN
	DECLARE  no_more_rows INT DEFAULT 0;
	DECLARE  userId,orgId,roleDefaultId,roleUserId,roleMemberId,roleAdminId,id BIGINT DEFAULT 0;
	DECLARE  userName VARCHAR(255);
	DECLARE num_rows INT DEFAULT 0;
	DECLARE users CURSOR FOR select lu.id,lu.orgId,lu.userId from light_user lu;
	DECLARE CONTINUE HANDLER FOR NOT FOUND SET  no_more_rows = 1;
	select obj.id into roleDefaultId from light_obj_role obj where obj.name= 'role_guest';
	select obj.id into roleUserId from light_obj_role obj where obj.name= 'role_user';
	select obj.id into roleMemberId from light_obj_role obj where obj.name= 'role_member';
	select obj.id into roleAdminId from light_obj_role obj where obj.name= 'role_admin';
	set id=id+1;
	OPEN users;
	select FOUND_ROWS() into num_rows;
	the_loop: LOOP
	FETCH users into userId,orgId,userName;
	IF no_more_rows THEN
	CLOSE users;
	LEAVE the_loop;
	END IF;
	select userId,orgId,userName,roleDefaultId,roleUserId,roleMemberId,roleAdminId,num_rows;
	if left(userName,8) = 'default@' then
	insert into light_user_obj_role (id,userId,orgId,objectId,objectTypeId,roleId) 
	values (id,userId,orgId,orgId,1,roleDefaultId);
	set id=id+1;
	else 
	if STRCMP(left(userName,6),'admin@') = 0 then
	insert into light_user_obj_role (id,userId,orgId,objectId,objectTypeId,roleId) 
	values (id,userId,orgId,orgId,1,roleUserId);
	set id=id+1;
	insert into light_user_obj_role (id,userId,orgId,objectId,objectTypeId,roleId) 
	values (id,userId,orgId,orgId,1,roleMemberId);
	set id=id+1;
	insert into light_user_obj_role (id,userId,orgId,objectId,objectTypeId,roleId) 
	values (id,userId,orgId,orgId,1,roleAdminId);
	set id=id+1;
	else
	insert into light_user_obj_role (id,userId,orgId,objectId,objectTypeId,roleId) 
	values (id,userId,orgId,orgId,1,roleUserId);
	set id=id+1;
	insert into light_user_obj_role (id,userId,orgId,objectId,objectTypeId,roleId) 
	values (id,userId,orgId,orgId,1,roleMemberId);
	set id=id+1;
	end if;
	end if;
	END LOOP the_loop;
	END$$
	DELIMITER;

Version 1.0.1
	New features:
	- supports OpenID authentication.
	- it will show topic when replying Forum. 
	- create new paginator page which is reused by rss, recommended news etc.
	- rss reader can detect iframe, if it is from iframe, then set flag.
	Internal Forum will check flag to show layout or just content.
	- create ConnectionService/ConnectionDao
	Bugs:
	- Light.js load the javascript before the html page for loading/refresh portlet content.
	- lost current page when refresh browser.
	- when moving portlet position, the highlighter position is not correct.
	- flashGamePortlet and it's JSP bugs.
	- group portlets bugs.
	- my Music portlet wrong url bugs.
	- rss forum/blog feed doesn't support utf-8.
	- send message bugs from friends and forum portlet.
	- hard code url prefix for profile, group URL.
	- my horoscope portlet bugs.
	
Version 1.0.0
Light Portal project proudly announced Light Portal version 1.0 on Feb 09, 2009. This version is the most 
stable version ever. 

  Highlight:
  - add color dropdown list to allow user to select 216 colors for portal text/portlet window color.
  - upgrade portlet window icon.
  - minor bugs fixed.
  - updated documents.

Version 1.0.0 Beta3

  New features:
  - Added controllers and chain to main servlet to
    allow developers to easily customize and maintain servlet workflow.
  - Added page friendly URL new feature.
  - Added configuration icon to none window style portlet window. (When user move
    mouse over none window style portlet area, it will show a configuration icon and
    it will be hidden when user move mouse out of that portlet).    

  Bugs:
  - Fixed Group friendly URL bug.
  - Fixed online chatting bugs.
  - Fixed weather portlet bug.
    
  Database Schema change:
  - alter table light_chatting_record modify column content text;
                
Version 1.0.0 Beta2
  - This version is a major release candidate for Light Portal final version 1.0.0, 
    it includes lots of new features and bugs fixed.   
    
  - Database Schema change
    Database schema files is located at <Light_Root>/WebContent/WEB-INF/dbscripts/.
    If you already have Light Portal 1.0 Beta1 database table structure, please run the following SQL for upgrading.
    And Please check before you do run the SQL, maybe your version already included these change.

    alter table light_forum add column (orgId bigint(20));
    update light_forum set orgId=1 where categoryId = 1;

    alter table light_forum_post add column (orgId bigint(20));
    update light_forum_post set orgId=1;

    alter table light_chat_buddy rename light_connection;

    alter table light_blog add column postedById bigint(20);
    update light_blog set postedById=userId;

    alter table light_internal_news add column orgId bigint(20);
    update light_internal_news set orgId=1;
    alter table light_portal add column maxShowTabs integer;
    update light_portal set maxShowTabs=10;
    alter table light_organization add column parentId bigint(20);
    update light_organization set parentId=0;
   